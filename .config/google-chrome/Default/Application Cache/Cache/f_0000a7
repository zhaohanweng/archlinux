IV.prototype.IXa=ea(223,function(a){this.J=Pb(arguments,0)});function Gsc(a,b,c,d,e){return pAb(a,t(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function QW(a,b){return B(a,2,b)}function RW(a){ci(this,a,0,-1,null)}u(RW,bi);function SW(a){ci(this,a,0,-1,null)}u(SW,bi);function Hsc(a){return a}var Isc=[3],Jsc=[1],Ksc=[1],Lsc=[1],Msc=[1,2],Nsc=[2];
function Osc(a,b){var c=zc(a,1)?B(a,1):Number.MIN_VALUE;a=zc(a,2)?Md(a):Number.MAX_VALUE;var d=zc(b,1)?B(b,1):Number.MIN_VALUE;b=zc(b,2)?Md(b):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function Psc(a){return lc(Joc,function(b){return b.match(a)}).getName()}function Qsc(a){ci(this,a,0,-1,null)}u(Qsc,bi);Qsc.prototype.Nf=function(){return L(this,2)};function Rsc(a){ci(this,a,0,-1,null)}u(Rsc,bi);Rsc.prototype.getChartType=function(){return L(this,1)};function Ssc(a){ci(this,a,0,-1,null)}u(Ssc,bi);
function Tsc(a){ci(this,a,0,-1,Isc)}u(Tsc,bi);Tsc.prototype.getChartType=function(){return L(this,1)};function Usc(a){ci(this,a,0,-1,Jsc)}u(Usc,bi);function Vsc(a){ci(this,a,0,-1,Ksc)}u(Vsc,bi);function Wsc(a){ci(this,a,0,-1,Lsc)}u(Wsc,bi);function Xsc(a){ci(this,a,0,-1,Msc)}u(Xsc,bi);var Ysc={XCc:0,GDa:1,eEa:2};function Zsc(a){ci(this,a,0,-1,Nsc)}u(Zsc,bi);
var $sc={S6a:0,SUM:1,AVERAGE:2,iia:3,f7a:4,k6a:5,MEDIAN:6,COUNT:7,f6a:8,g6a:9},atc={UNKNOWN_ERROR:0,wDc:1,muc:2,fgc:3},btc={jDc:0,zgc:1,wha:2,Ak:3,cDc:4,I7b:5,Phc:6},ctc={hDc:0,xF:1,suc:2,Ytc:3,Jwc:4},dtc={dDc:0,ouc:1,XK:2,xrc:3},etc={VCc:0,GCc:1,ykc:2,DBc:3,CBc:4,dac:5,psc:6},ftc={NAc:0,TABLE:1,G1a:2,BCc:3,Dzc:4,Y4a:5,vDc:6,mBa:7,gza:8,Nza:9,HISTOGRAM:10},gtc={UNKNOWN:0,t7b:1,s7b:2,r7b:3,J8b:4,v$b:5,Y$b:6,Edc:7,bhc:8,Tsc:9,Wwc:10,exc:11,XAc:12,YAc:13,hCc:14,wwc:15};function TW(){y.call(this)}u(TW,y);var htc=null;TW.prototype.Em=function(){return B(this,1)};function UW(){y.call(this)}u(UW,y);var itc=null;UW.prototype.getText=function(){return B(this,1)};UW.prototype.ls=function(){return zc(this,1)};function VW(){y.call(this)}u(VW,y);var jtc=null;VW.prototype.getStatus=function(){return B(this,1)};VW.prototype.getError=function(){return B(this,9)};function WW(){y.call(this)}u(WW,y);var ktc=null;function XW(){y.call(this)}u(XW,y);var ltc=null;
function YW(){y.call(this)}u(YW,y);var mtc=null;YW.prototype.wca=function(){return zc(this,1)};YW.prototype.getType=function(){return B(this,3)};YW.prototype.setType=function(a){C(this,3,a)};function ZW(){y.call(this)}u(ZW,y);var ntc=null;function $W(){y.call(this)}u($W,y);var otc=null;
TW.prototype.Pa=function(){var a=htc;a||(htc=a=Gc(TW,{0:{name:"Error",Mb:"ritz.assistant.Error"},1:{name:"message",Ma:9,type:String},2:{name:"code",Ma:14,defaultValue:0,type:atc},3:{name:"unsupported_op_reason",Ma:14,defaultValue:0,type:btc}}));return a};TW.Pa=TW.prototype.Pa;
UW.prototype.Pa=function(){var a=itc;a||(itc=a=Gc(UW,{0:{name:"AnswerQueryPhrase",Mb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ma:9,type:String},2:{name:"start_byte",Ma:5,type:Number},3:{name:"num_bytes",Ma:5,type:Number}}));return a};UW.Pa=UW.prototype.Pa;
VW.prototype.Pa=function(){var a=jtc;a||(jtc=a=Gc(VW,{0:{name:"AnswerResponse",Mb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ma:5,type:Number},10:{name:"parse_status",Ma:14,defaultValue:0,type:ctc},11:{name:"answer_status",Ma:14,defaultValue:0,type:dtc},2:{name:"formula",Ma:9,type:String},3:{name:"debug_parse_response",Ma:9,type:String},4:{name:"interpretation",Ma:9,type:String},5:{name:"debug_interpretation_response",Ma:9,type:String},6:{name:"unused_phrase",Uc:!0,Ma:11,type:UW},7:{name:"used_entity_phrase",
Uc:!0,Ma:11,type:UW},8:{name:"unused_entity_phrase",Uc:!0,Ma:11,type:UW},9:{name:"error",Ma:11,type:TW},12:{name:"alternate_suggestion",Uc:!0,Ma:11,type:YW},14:{name:"deprecated_formula_builder_used",Ma:9,type:String},15:{name:"answer_visualization_type",Uc:!0,Ma:14,defaultValue:0,type:ftc},16:{name:"formula_builder_used",Ma:14,defaultValue:0,type:gtc},17:{name:"charting_info",Ma:11,type:XW},18:{name:"answer_field_info",Uc:!0,Ma:11,type:WW},19:{name:"charting_formula",Ma:9,type:String},21:{name:"parse_info",
Uc:!0,Ma:11,type:ZW},22:{name:"answer_field_info_for_ranges",Uc:!0,Ma:11,type:WW},23:{name:"va_query",Ma:9,type:String},24:{name:"pivot_table_def",Ma:11,type:Oe}}));return a};VW.Pa=VW.prototype.Pa;WW.prototype.Pa=function(){var a=ktc;a||(ktc=a=Gc(WW,{0:{name:"AnswerFieldInfo",Mb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ma:14,defaultValue:0,type:Kea},2:{name:"range_ref",Ma:9,type:String}}));return a};WW.Pa=WW.prototype.Pa;
XW.prototype.Pa=function(){var a=ltc;a||(ltc=a=Gc(XW,{0:{name:"ChartingInfo",Mb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Uc:!0,Ma:14,defaultValue:0,type:ftc},2:{name:"recommended",Ma:8,type:Boolean},3:{name:"user_requested_type",Uc:!0,Ma:14,defaultValue:0,type:ftc},4:{name:"show_only_chart",Ma:8,type:Boolean}}));return a};XW.Pa=XW.prototype.Pa;
YW.prototype.Pa=function(){var a=mtc;a||(mtc=a=Gc(YW,{0:{name:"QuerySuggestion",Mb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ma:9,type:String},2:{name:"formula",Ma:9,type:String},3:{name:"type",Ma:14,defaultValue:0,type:etc},4:{name:"deprecated_formula_builder_used",Ma:9,type:String},5:{name:"formula_builder_used",Ma:14,defaultValue:0,type:gtc}}));return a};YW.Pa=YW.prototype.Pa;
ZW.prototype.Pa=function(){var a=ntc;a||(ntc=a=Gc(ZW,{0:{name:"ParseInfo",Mb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Uc:!0,Ma:11,type:$W}}));return a};ZW.Pa=ZW.prototype.Pa;$W.prototype.Pa=function(){var a=otc;a||(otc=a=Gc($W,{0:{name:"IntentInfo",Mb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ma:14,defaultValue:0,type:$sc}}));return a};$W.Pa=$W.prototype.Pa;function aX(a,b,c,d,e,f){H.call(this,a,b);this.C=b;this.va=c;this.$=d||null;this.Qa=e||null;this.J=f||null}u(aX,H);aX.prototype.zj=g("va");aX.prototype.We=g("$");function ptc(a,b,c,d,e,f,h){h=void 0===h?null:h;aX.call(this,"Ce",null,d,e,f);this.L=a;this.V=b;this.zc=c;this.F=h}u(ptc,aX);ptc.prototype.Ed=g("zc");function qtc(a,b,c){aX.call(this,"Fe",null,2859);this.L=a;this.V=b;this.F=c}u(qtc,aX);function rtc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(jn?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(jn?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function bX(){}u(bX,OJ);za(bX);bX.prototype.Ec=n("waffle-assistant-link-button");function stc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function ttc(a,b){R.call(this,b);this.D=a;this.C=new Hs("",new bX,this.xa());this.Ta(this.C)}u(ttc,R);p=ttc.prototype;p.Da=function(){this.La=S(stc)};p.Sa=function(){ttc.ea.Sa.call(this);var a=this.$a("waffle-assistant-feedback-card-link");this.C.ob(a);this.getHandler().R(this.La,"mousedown",this.Tg).R(this.C,"action",this.uvb);this.show(!1)};p.Tg=function(a){a.stopPropagation()};
p.show=function(a){var b=this.La,c=this.$a("waffle-assistant-feedback-card-link");Gp(b,"waffle-assistant-feedback-card-hidden",!a);vm(c,a)};p.uvb=function(){O.nz.Ac({source:this.D});this.show(!1);this.dispatchEvent(new H("feedback-dialog-opened"))};function cX(){}u(cX,Fs);za(cX);cX.prototype.Ec=n("waffle-assistant-button");function dX(a,b,c){a&&(q(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Xa(b),Ns(a,b,void 0),hlc(a),a.setAttribute("data-tooltip-delay",500),pYb(a,q(c)?c:1))};function utc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(Zt({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(Zt({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function eX(a){R.call(this,a);this.C=new Hs("",new cX,this.xa());this.Ta(this.C);this.D=new Hs("",new cX,this.xa());this.Ta(this.D)}u(eX,R);eX.prototype.Da=function(){this.La=S(utc)};eX.prototype.Sa=function(){eX.ea.Sa.call(this);var a=this.$a("waffle-assistant-thumbs-down-button");this.C.ob(a);dX(a,"Not useful");a=this.$a("waffle-assistant-thumbs-up-button");this.D.ob(a);dX(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function vtc(a,b){a.xa().nf(a.$a("waffle-assistant-thumbs-text"),b)}eX.prototype.F=function(){this.dispatchEvent(new H("thumbs-down"));Q(this.La,!1)};eX.prototype.H=function(){this.dispatchEvent(new H("thumbs-up"));Q(this.La,!1)};function fX(a,b){var c=this;R.call(this,b);this.D=a;this.$=this.V=this.O=null;this.hb=new OV(!0,"#4285f4");this.Ta(this.hb);this.jb=this.Kb=this.dc=!1;this.Na=new Ck(function(){c.Na.stop();c.La.parentNode.querySelector(":hover")==c.La?c.Na.start():c.WU()},100);F(this,this.Na);this.Fd=this.Cb=!1}u(fX,R);p=fX.prototype;p.iF=Vf;p.yca=Wf;p.uH=Xf;p.tH=Xf;p.Kaa=Xf;p.Zoa=Xf;p.Yoa=Xf;p.Ze=ca("Fd");p.Gd=g("Fd");p.Rqa=xa;p.Da=function(){this.La=S(rtc)};
p.Sa=function(){fX.ea.Sa.call(this);var a=this.$a("waffle-assistant-card-spinner-container");this.hb.render(a);Kp(this.$a("waffle-assistant-card-inner"),"visibility","hidden");if(this.iF()){a=this.La;var b=new Jp(a);F(this,b);this.getHandler().R(b,"focusin",this.fqb).R(b,"focusout",this.eqb).R(a,"mouseenter",this.E2).R(a,"mouseleave",this.WU)}wtc(this,!1);jn&&(this.$=new ttc(this.XC(),this.xa()),this.$.render(this.$a("waffle-assistant-card-feedback-container")),this.getHandler().R(this.$,"feedback-dialog-opened",
this.vvb).R(this,"trigger_feedback",this.f_b),this.yca()?(this.V=new eX(this.xa()),this.V.render(this.$a("waffle-assistant-thumbs-container")),xtc(this,!0),a=ib(this.Kaa()),Ua(a)||vtc(this.V,a),a=ib(this.Zoa()),Ua(a)||dX(this.V.$a("waffle-assistant-thumbs-up-button"),a),a=ib(this.Yoa()),Ua(a)||dX(this.V.$a("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.V,"thumbs-down",this.x4b).R(this.V,"thumbs-up",this.y4b)):xtc(this,!1));this.dF()};
function gX(a){return a.$a("waffle-assistant-card-content-container")}function ytc(a){a.iF();return a.$a("waffle-assistant-card-options")}function xtc(a,b){jn&&Q(a.$a("waffle-assistant-thumbs-container"),a.yca()&&b)}p.JL=function(){this.isDisposed()||(this.dc=!0,ztc(this))};function Atc(a,b){!a.Kb&&b&&(a.Kb=!0,ztc(a))}function ztc(a){if(a.dc&&a.Kb){var b=t(a.w4b,a);a.jF(b)}}p.E2=function(){this.jb||(wtc(this,!0),this.jb=!0,this.Na.start())};p.WU=function(){wtc(this,!1);this.jb=!1};
p.fqb=function(){wtc(this,!0)};p.eqb=function(){var a=this,b=new Ck(function(){rm(a.La,document.activeElement)||a.La.parentNode.querySelector(":hover")==a.La||wtc(a,!1)},0);F(this,b);b.start()};p.x4b=function(){Btc(this,!0);xtc(this,!1);var a=this.tH();this.dispatchEvent(new aX("He",this,a))};p.y4b=function(){xtc(this,!1);var a=this.uH();this.dispatchEvent(new aX("He",this,a))};p.vvb=function(){Btc(this,!1)};p.f_b=function(){Btc(this,!0)};
function wtc(a,b){var c=a.$a("waffle-assistant-card-options");a=a.iF();Q(c,a&&b)}p.w4b=function(){this.hb.setActive(!1);Q(this.hb.La,!1);Kp(this.$a("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new H("content-rendered"))};function Btc(a,b){Gp(a.$a("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.$.show(b)};function Ctc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(Os({Ae:"waffle-assistant-section-more-button",content:Pr("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function Dtc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function Etc(){var a=V;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(Dtc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function Ftc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(Os({Ae:"waffle-assistant-panel-back-button",content:Pr(""+U(Zt({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function hX(a){R.call(this,a);this.Xb=new OV(!1,"#4285f4");this.Ta(this.Xb);this.J=new R(this.xa());this.Ta(this.J);this.C=[];this.Ld=this.Ye=!1;this.Ic=this.wc=this.cb=this.O=null;this.Kb=new Ps("",a,4);mr(this.Kb,2,!1);this.Ta(this.Kb)}u(hX,R);var Gtc={defaultHelpArticleId:"6280499"};p=hX.prototype;p.Da=function(){hX.ea.Da.call(this);this.La=S(Etc);this.wc=this.$a("waffle-assistant-panel-content-container");this.Ic=this.$a("waffle-assistant-empty-list")};
p.Sa=function(){hX.ea.Sa.call(this);var a=this.$a("waffle-assistant-spinner-container");this.Xb.render(a);this.J.ob(this.$a("waffle-assistant-panel-card-holder"));this.Kb.ob(this.$a("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Kb,"action",this.z4b).R(this.La,"scroll",slc(this.Nga,10,this))};p.setVisible=function(a){var b=this;Q(this.La,a);x(this.C,function(a){if(!a.gc()){var c=b.J.jd();a.O=c;b.J.Ta(a,!0);a.JL()}});this.Ye=a};
p.Bva=function(a,b){var c=this.xa();this.O&&this.K9();this.O=new R;this.Ta(this.O);a=Fr(a,Ftc,{title:b});this.cb=new Ps("",this.xa());this.O.Ta(this.cb);this.cb.ob(c.$a("waffle-assistant-panel-back-button",a));dX(this.cb.La,"Back");this.O.getHandler().R(this.cb,"action",this.Bpb)};p.K9=function(){this.O.dispose();this.O=null};function Htc(a,b){a.Xb.setActive(b);Q(a.$a("waffle-assistant-panel-pane"),!b)}p.nJ=function(a){Q(this.Ic,a);Q(this.wc,!a)};
function Itc(a,b){Jb(a.C,b);a.J.removeChild(b);a.J.Nh(b,0);a.C.push(b)}p.aJ=function(a){Jb(this.C,a);-1!=xq(this.J,a)&&this.J.removeChild(a,!0)};p.R_=function(){this.J.Kd(!0);Ic(this.C);this.C=[]};p.Nga=function(){var a=this.La;a=a.scrollTop+bq(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(Atc(d,!0),b+=bq(d.La).height):Atc(d,!1)}};p.Ze=function(a){this.Ld=a;x(this.C,function(b){b.Ze(a)})};p.Gd=g("Ld");p.z4b=function(){O.Ro.Ac(Gtc)};p.Bpb=function(){this.dispatchEvent("ze")};function iX(a,b,c,d){R.call(this,d);this.V=a;this.hb=b;this.$=new Ps("",this.xa());this.Ta(this.$);this.J=new R(this.xa());this.Ta(this.J);this.C=null;this.cb=[];this.Ya=this.Qa=!1;this.Jb=c}u(iX,R);p=iX.prototype;p.LQa=Vf;p.Gwa=Wf;p.Da=function(){iX.ea.Da.call(this);this.La=S(Ctc,{title:this.wX()})};
p.Sa=function(){iX.ea.Sa.call(this);this.J.ob(this.$a("waffle-assistant-section-card-holder"));this.$.ob(this.$a("waffle-assistant-section-more-button"));this.getHandler().R(this.$,"action",this.rAb);this.C=this.CGa();F(this,this.C);Q(Jtc(this),this.LQa());this.setVisible(!1)};p.setVisible=function(a){if(this.gc()&&this.kb()!=a&&(Q(this.La,a),a)){Q(this.$.La,this.uYa());a=new ri;N(a,4,this.Mga());var b=new pi;ji(b,58,a);a=Ai(zi(new yi,10),b).build();this.Jb.hc(2774,a)}};
p.kb=function(){return this.gc()&&eq(this.La)};p.uYa=function(){return this.cb.length>this.V};p.CGa=function(){return new hX(this.xa())};p.Ze=function(a){this.Ya=a;x(Ktc(this),function(b){b.Ze(a)});this.C.Ze(a)};p.Gd=g("Ya");p.dg=xa;
p.d6=function(a){this.cb=a;for(var b=0;b<a.length;b++){if(this.J.jd()<this.V){var c=this.b0(a[b]);c.Ze(this.Ya);var d=this.J.jd();c.O=d;this.J.Ta(c,!0)}if(this.Gwa()&&(this.C.nJ(!1),c=this.C,d=this.b0(a[b]),c.C.push(d),c.Ye)){Htc(c,!1);var e=c.J.jd();d.O=e;c.J.Ta(d,!0);d.JL()}}};function Ktc(a){var b=[];a.J.Zf(function(a){b.push(a)});return b}function Jtc(a){return a.$a("waffle-assistant-section-content")}p.Pra=function(){return this.J.sca()};
p.vX=function(){this.cb=[];Ic(this.J.Kd(!0));this.setVisible(!1);this.Gwa()&&(this.C.R_(),this.C.nJ(!0))};function Ltc(a){a.J.Zf(function(a,c){c<this.V&&a.JL()},a)}p.e6=function(a){var b=0;if(this.Qa)this.C.Nga();else if(this.Pra()){this.setVisible(!0);b=bq(this.$a("waffle-assistant-section-header")).height+bq(Jtc(this)).height;for(var c=Ktc(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.XNa(c[d]),Atc(c[d],!0),b+=bq(c[d].La).height):Atc(c[d],!1)}else this.setVisible(!1);return a-b};p.XNa=xa;
p.setActive=function(a){(this.Qa=a)||this.C.K9()};p.$b=g("Qa");function Mtc(a,b){a.C.Bva(b,a.wX())}p.rAb=function(){this.setActive(!0);this.dispatchEvent("Ee")};p.bt=g("Jb");var Ntc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function Otc(a){var b=new RC(tc(Ntc));return $nc(a,b)}
function Ptc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.fc("useFirstColumnAsDomain")&&a.Ed()&&"number"===a.Ed().ad(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.fc("useFirstColumnAsDomain")&&a.Ed()&&"string"===a.Ed().ad(0)){c=0;var d=cm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Ed().getNumberOfRows();b++)tm(d,a.Ed().Of(b,0)),c=Math.max(c,iq(d).width);jm(d);c=Math.min(27,Math.max(15,10+100*c/271))}oP()||qn||(a.setOption("chartArea.top","15%"),b=a.fc("hAxis.title"),a.setOption("chartArea.height",Ua(ib(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Ua(ib(a.fc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function Qtc(a,b,c){var d=a.Nc(),e=a.Sc();switch(b){case 0:d=Math.min(d,a.tc()+c);break;case 1:e=Math.min(e,a.qc()+c)}return Bh(a.Lb(),a.tc(),a.qc(),d,e)}function Rtc(a){var b=new Dia;N(b,1,""+a.Yc);var c=a.rect.tc();N(b,2,c);c=a.rect.Nc();N(b,3,c);c=a.rect.qc();N(b,4,c);a=a.rect.Sc();N(b,5,a);return b}function Stc(a){var b=new pi;if(a){var c=new ri;a=Rtc(a);ji(c,7,a);ji(b,58,c)}return b};function Ttc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function Utc(){return V(U(Os({Ae:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Pr(""+U(Zt({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(Os({Ae:"waffle-assistant-zoom-button",content:Pr(""+U(Zt({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function Vtc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.d$a)+"</span>"),d=0==a.UJa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.UJa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+U(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(jn?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function Wtc(a,b,c,d,e,f,h){R.call(this,h);this.F=a;this.D=b;this.J=e;this.Jb=f;this.C=this.zc=null;this.H=zi(new yi,10).build()}u(Wtc,R);p=Wtc.prototype;p.Sa=function(){Wtc.ea.Sa.call(this);(new ZU(hD,this.D.hf())).send(t(this.Msb,this,this.D))};p.Rqa=function(a,b){a=new ptc(this.F.clone(),this.J,this.zc,2746,a,b);this.dispatchEvent(a)};p.Msb=function(a,b){b&&(b.Ki()?FC.hC(this.La,b):(b=b.Ed(),a.we(b),tV(a,b),GC(a,"ready",t(this.l4b,this,a)),GV(a,this.La,this.Jb,qn),this.zc=b))};
p.l4b=function(a){a.nm()&&(GC(a.nm(),"onmouseover",t(this.j4b,this)),GC(a.nm(),"onmouseout",t(this.k4b,this)))};p.j4b=function(){this.C=Ka()};p.k4b=function(){ta(this.C)&&500<Ka()-this.C&&this.Jb.hc(2750,this.H);this.C=null};function Xtc(a,b,c,d,e){R.call(this,e);this.J=a;this.Na=b;this.Jb=c;this.O=d;this.L=Ec(this.J,23);this.Ha=B(this.J,22);this.D=B(this.J,26);this.Ca=[];this.qd=new Ah;this.V=this.F=this.C=null;this.$=!1;this.va=new Ps("",this.xa());this.Ta(this.va);this.H=null}u(Xtc,R);p=Xtc.prototype;p.Da=function(){Xtc.ea.Da.call(this);this.La=S(Vtc,{d$a:this.D,UJa:this.L});this.La.style.visibility="hidden"};
p.Sa=function(){Xtc.ea.Sa.call(this);var a=this.$a("waffle-assistant-facet-toggle");this.va.ob(a);this.getHandler().R(this.La,"mousedown",this.Tg).R(this.va,"action",this.tIb);jn&&(this.V=new ttc("assistantAutovisFacetFeedback",this.xa()),this.V.render(this.$a("waffle-assistant-facet-feedback-container")),this.C=new eX(this.xa()),this.Ta(this.C),this.C.render(this.$a("waffle-assistant-facet-thumbs-container")),vtc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.i4b).R(this.C,"thumbs-down",this.h4b));Ytc(this,vsa)};p.Gd=g("$");p.Ze=function(a){this.$=a;Ztc(this)};p.Tg=function(a){a.stopPropagation()};p.tIb=function(){var a=Ap(this.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");Ytc(this,a);$tc(this,a?2647:2646)};
function Ytc(a,b){var c=a.$a("waffle-assistant-facet-toggle");tm(c,b?"HIDE":"SHOW");Gp(a.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);x(a.Zi("waffle-assistant-faceted-chart"),function(a){vm(a,b)});a.C&&Q(a.C.La,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');dX(c,b?a:d)}
function auc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function buc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function Ztc(a){a.O&&!a.$&&x(a.Ca,t(function(a){var b=a.La;if(!this.O.contains(b)){var d=this.O;a=new cuc(b,a);fpb(d,a)}},a))}p.i4b=function(){$tc(this,2649)};p.h4b=function(){$tc(this,2648);this.V.show(!0)};function $tc(a,b){var c=a.Jb,d=new CV,e=a.H.getChartType();d.C=e;e=a.H.Ed();d.F=e?e.clone():null;DV(c,b,d,10,a.H,a.H.hf())};function jX(a,b,c,d,e,f,h){fX.call(this,a,h);this.C=B(a,8);this.Ic=b;this.wc=c;this.Jb=d;this.cb=e;this.Wc=f;this.L=new Ps("",this.xa());this.Ta(this.L);this.va=new Ps("",this.xa());this.Ta(this.va);this.qd=new Ah;this.Xb=null;this.Qa=!1;this.Ub=[];this.Ob=[];this.pb=[];this.Ya=this.Ha=this.F=this.H=this.Ca=null;a=Stc(this.Wc);this.J=Ai(zi(new yi,10),a).build()}u(jX,fX);
var kX={L0a:"waffle-assistant-after-chart-preview",e1a:"waffle-assistant-before-chart-preview",o1a:"waffle-assistant-card-draggable",i7:"waffle-assistant-chart-highlights",Q3a:"waffle-assistant-insert-chart-button",Gia:"waffle-assistant-chart-preview",N5a:"waffle-assistant-button-separator",n6a:"waffle-assistant-styled-border",o6a:"waffle-assistant-styled-rect",t7a:"waffle-assistant-zoom-button"};p=jX.prototype;p.jF=function(a){this.Xb=a;duc(this)};
p.dF=function(){euc(this,t(function(a){a=cpc(this.Ic,a);yp(this.La,a)},this),!1)};p.iF=Wf;p.XC=n("autovisFeedback");p.uH=n(2208);p.tH=n(2207);p.Kaa=n("Was this chart useful?");p.Da=function(){jX.ea.Da.call(this);gX(this).appendChild(S(Ttc));ytc(this).appendChild(S(Utc));zc(this.C,22)&&(this.F=new Xtc(this.C,this.O,this.Jb,this.cb,this.xa()),this.Ta(this.F,!0),this.F.Ze(this.Gd()))};
p.Sa=function(){jX.ea.Sa.call(this);Bp(this.La,kX.o1a);var a=this.$a(kX.Q3a);this.L.ob(a);dX(a,"Insert chart");a=this.$a(kX.t7a);this.va.ob(a);dX(a,"View full size");a=this.$a(kX.e1a);var b=this.$a(kX.Gia),c=this.$a(kX.L0a);this.getHandler().R(this.La,"keydown",this.e4b).R(b,"click",this.Mqb).R(a,"focus",this.Kpb).R(c,"focus",this.Aob).R(this.L,"action",this.Xxb).R(this.L.La,"mousedown",this.Tg).R(this.va,"action",this.cKb).R(this.va.La,"mousedown",this.Tg).R(this.$a(kX.i7),"mousedown",this.Tg).R(zv(this.Ic),
"Ea",this.f4b);fuc(this);this.Jb.hc(2790,this.J);this.F&&this.Jb.hc(2791,this.J)};p.Ze=function(a){jX.ea.Ze.call(this,a);fuc(this);this.gc()&&guc(this)};function fuc(a){if(a.gc()){var b=a.Gd();a.L.setVisible(!b);a=a.xa().$a(kX.N5a,ytc(a));Q(a,!b)}}p.e4b=function(a){13==a.keyCode&&a.target==this.La&&(a.preventDefault(),a.stopPropagation(),huc(this,2255))};
function iuc(a){var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=jU(Ec(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var r=juc(h[m].rect,c!=b);Ob(l,r)}c=lB(a.wc).od();var v=[];for(w in Og)v.push(keb(c,Og[w]));var w=vb(l,function(a){return vb(v,Ia(kh,a))});f&&e&&(w=Pb(w,1));a.pb=kuc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=lB(a.wc);for(e=0;e<w.length;e++)for(f=a.pb[e],b=0;b<w[e].length;b++)w[e][b]&&wh(w[e][b])&&(k=Vjc(d,w[e][b],kX.o6a),F(a,k),$G(uI(d),
k,!0),Kp(k.La,"background-color",f),k.setVisible(!0),a.Ub.push(k),k=ZH(d,w[e][b],kX.n6a,1,0),F(a,k),ghb(k,f),k.setVisible(!0),a.Ob.push(k))}function luc(a){Ic(a.Ub);Ic(a.Ob);a.Ub=[];a.Ob=[];a.pb=[]}p.f4b=function(){this.Qa&&(luc(this),iuc(this))};p.E2=function(){jX.ea.E2.call(this);this.Ha=Ka();this.Qa||(iuc(this),this.Qa=!0)};p.WU=function(){jX.ea.WU.call(this);ta(this.Ha)&&500<Ka()-this.Ha&&this.Jb.hc(2789,this.J);this.Ha=null;luc(this);this.Qa=!1};p.Mqb=function(){this.La.focus()};
p.Kpb=function(){var a=this.$a(kX.i7);eq(a)?a.focus():this.La.nextSibling&&this.La.nextSibling.focus()};p.Aob=function(){var a;if(a=this.$)a=this.$,a.Fb("waffle-assistant-feedback-card-hidden")?a=!1:(a.$a("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.va.La.focus()};p.Xxb=function(){huc(this,2255)};p.Tg=function(a){a.stopPropagation()};p.cKb=function(){X.t6.Ac(this,this.J)};p.Rqa=function(a,b){huc(this,2257,a,b)};
function huc(a,b,c,d){euc(a,t(function(a){a=new ptc(a,this.O,this.H&&this.H.Ed(),b,c,d,nja(this.J));this.dispatchEvent(a)},a),!1)}
p.g4b=function(a,b){if(b){var c=this.$a(kX.Gia);if(b.Ki())FC.hC(c,b);else{a.we(b.Ed());tV(a,a.Ed());bU(a,"ready",t(this.d4b,this,a));b=[];try{var d=new lf;d.setContext(a.toJSON());var e=!!B(this.C,14);C(d,3,e);var f=B(this.C,16);C(d,4,f);C(d,5,"ROWS"==(e?"ROWS":"COLS"));C(d,8,0);if(B(this.C,24)){var h=B(this.C,25);C(d,9,h)}var k=jU(Ec(this.D,4));for(e=0;e<k.length;e++)d.addRange(Eh(k[e].rect,k[e].Yc));var l=this.qd.serialize(d);b=vb(Spc(Ia(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
Ppc)}catch(m){b=[]}d=this.$a(kX.i7);Q(d,0<b.length);0<b.length&&(d.appendChild(b[0]),vm(d,!0));this.H=a;GV(a,c,this.Jb,qn)}}};p.d4b=function(a){null!==this.Ca&&(Wi(Ui.getInstance(),this.Ca),this.Ca=null);this.isDisposed()||(a.nm()&&(GC(a.nm(),"onmouseover",t(this.b4b,this)),GC(a.nm(),"onmouseout",t(this.c4b,this))),this.Xb(),guc(this))};p.b4b=function(){this.Ya=Ka()};p.c4b=function(){ta(this.Ya)&&500<Ka()-this.Ya&&this.Jb.hc(2795,this.J);this.Ya=null};
function guc(a){if(a.cb&&!a.Gd()){var b=a.$a(kX.Gia);if(!a.cb.contains(b)){var c=a.cb;a=new cuc(b,a);fpb(c,a)}}}function muc(a){a.Cb&&(a.Ca=Vi(Ui.getInstance(),Fj.kza),a.Cb=!1);B(a.C,16);var b=Otc(a.C);b.rfa(hD);var c=boc(a.D);b.ji(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function duc(a){var b=muc(a);b=Ptc(b,a.$a("waffle-assistant-card-inner"));(new ZU(hD,b.hf())).send(t(a.g4b,a,b));a.F&&euc(a,t(function(a){var c=this.F,e=b;a=new RC(a.toJSON());e=new RC(e.toJSON());var f=c.Zi("waffle-assistant-faceted-chart");if(1<f.length){buc(a);var h=e;auc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");oP()||qn||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,buc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),auc(e);h=jU(Ec(c.J,27));e0a(c.F,h);h=B(c.J,25);for(var k=0;k<f.length;k++){var l=qa(c.L[k])?c.L[k]:null,m=h.clone(),r=c.Ha,v=new rf;C(v,1,r);qa(l)&&v.gb(l);C(m,7,v);c.F.Rb("dt",encodeURIComponent(JSON.stringify(c.qd.serialize(m))));
r=new RC(a.toJSON());r.ji(c.F.toString());m=e.clone();m.ji(c.F.toString());var w=c,z=r.fc("title");z||(z=Psc(r));v=z+(' when "'+(w.D+('" is "'+(l+'"'))));w=z+(' by "'+(w.D+'"'));v=l?v:w;r.setOption("title",v);m.setOption("title",v);w=new Wtc(r,m,0,0,c.Na,c.Jb,c.xa());c.Ta(w);v=f[k];w.ob(v);c.Ca.push(w);w=c;z=Psc(r);r=z+(' broken down by "'+(w.D+('" for "'+(l+'"'))));w=z+(' broken down by "'+(w.D+'"'));yp(v,l?r:w);c.H=m}Ztc(c);c.La.style.visibility="visible"},a),!1)}
function euc(a,b,c){var d=muc(a);(new ZU(hD,d.hf())).send(function(a){a?(a=a.Ed(),c&&d.we(a),tV(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function kuc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Rmc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ob(d,d);return d}function juc(a,b){return b?fkc(a,new $g(a.width,1)):fkc(a,new $g(1,a.height))};function cuc(a){qJ.apply(this,arguments)}ha(cuc,qJ);cuc.prototype.mpa=g("element");function nuc(){oJ.call(this);this.Qa.push(this);this.Ca=this.Ha=!0;this.jb="waffle-assistant-dragged-card"}u(nuc,epb);nuc.prototype.contains=function(a){return!!x(this.L,function(b){if(b.element==a)return!0})};nuc.prototype.kpa=function(a){var b=nuc.ea.kpa.call(this,a);if(oP()||qn){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=vb(b.querySelectorAll("clippath"),function(a){return a.id}),ouc(b,a);return b};
function ouc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];qa(c)&&cb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=lm(a);for(c=0;c<a.length;c++)ouc(a[c],b)};function puc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function lX(a,b){fX.call(this,a,b);this.C=B(a,8)}u(lX,fX);p=lX.prototype;p.dF=xa;p.XC=n("assistantWordCloudFeedback");p.uH=n(2634);p.tH=n(2633);p.Da=function(){lX.ea.Da.call(this);gX(this).appendChild(S(puc));Bp(gX(this),"waffle-assistant-word-cloud-content-container")};
p.jF=function(a){for(var b=Ec(this.C,19),c=Ec(this.C,20),d=this.$a("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(quc(this,b,c,e),120<d.clientHeight){quc(this,b,c,e-1);break}b=this.xa();c=B(this.C,2);c=Fm(b,c);d=this.$a("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function quc(a,b,c,d){var e=a.$a("waffle-assistant-word-cloud-words-container");for(a=a.xa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Fm(a," "));var l=a.createElement("SPAN");a.appendChild(l,Fm(a,b[k]));a.appendChild(e,l);Bp(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function mX(a,b,c,d,e){iX.call(this,20,d,c,e);this.va=a;this.L=b;this.D=new nuc;F(this,this.D);this.F=null;this.H=0;this.O=null}u(mX,iX);p=mX.prototype;p.Sa=function(){mX.ea.Sa.call(this);this.D.Ie();this.getHandler().R(this.D,"drag",this.a4b).R(this.D,"dragend",this.dn)};p.wX=n("Analysis");p.X8=function(a){return 0==a};p.b0=function(a){return"WordCloud"==B(a,8).getChartType()?new lX(a,this.xa()):new jX(a,this.va,this.L,this.bt(),this.D,this.O,this.xa())};
p.Ze=function(a){mX.ea.Ze.call(this,a);a&&Nob(this.D)};p.XNa=function(a){this.getHandler().Kc(a,"content-rendered",this.$3b);this.H++};p.d6=function(a,b){this.O=b||null;mX.ea.d6.call(this,a,b)};p.$3b=function(){0==--this.H&&this.dispatchEvent("Be")};p.a4b=function(){this.F=Yp(this.D.fd.target)};p.dn=function(a){var b=this.F,c=lB(this.L).pe();if(dh(jG(c,"page",!1,!1)).contains(b)){var d=gG(c,b.x,b.y,"page");c=lG(c,ih(d),"page");b=new Sg(b.x-c.left,b.y-c.top);a.C.getData().Rqa(d,b)}this.F=null};
p.Mga=n(2);function ruc(a){var b=[];if(zc(a,25)&&(a=B(a,25)))for(var c=0;c<Ac(a,1);c++){var d=B(a,1,c);if(zc(d,2)){var e=B(d,2);e&&b.push(suc(e,tuc(d)))}}return b}function uuc(a){var b=ruc(a);zc(a,6)&&(a=B(a,6))&&b.push(suc(a,0));return b}function tuc(a){return(a=zc(a,4)?B(a,4):0)?a:0}function suc(a,b){return{name:a,U7a:b}};function vuc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function nX(a){return vuc(a,1)[0]}function wuc(a){var b=0;x(a,function(c,d){c.length>a[b].length&&(b=d)});return vb(a[b],function(b,d){return vb(a,function(a){return a[d]})})}
function xuc(a){var b={};x(a,function(a){b[a]||(b[a]=0);b[a]++});Rb(a);Ub(a,function(a,d){return b[d]-b[a]})};function yuc(a,b,c){this.Ca=a;this.Ha=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.va=[];this.C=new og;this.F=new og;this.V=new og;this.D=new og;zuc(this,c)}function Auc(a,b){return pg(a,b)?a.get(b).values.kd():[]}
function zuc(a,b){for(var c=new tg,d=new tg,e=0;e<b.length;e++){for(var f=uuc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(pg(a.Ca,m)){var r=a.Ca.get(m);c.add(r);h.push(r)}pg(a.Ha,m)&&(m=a.Ha.get(m),d.add(m),k.push(m))}Buc(a,h,k)}a.L=c.kd();a.O=d.kd();Ub(a.L);Ub(a.O);a.H=vb(a.C.kd(),function(a){return a.key});Ub(a.H);a.J=vb(a.F.kd(),function(a){return a.key});Ub(a.J);a.$=vb(a.V.kd(),function(a){return a.key});Ub(a.$);a.va=vb(a.D.kd(),function(a){return a.key});Ub(a.va)}
function Buc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)oX(a.C,b[d],b[e]),oX(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)oX(a.F,b[d],c[e]),oX(a.V,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)oX(a.D,c[b],c[d]),oX(a.D,c[d],c[b])}function oX(a,b,c){var d;pg(a,b)?d=a.get(b).values:d=new tg;d.add(c);a.set(b,{key:b,values:d})};function Cuc(a,b){this.C=a;for(var c=new og,d=0;d<Ac(a,2);d++)c.set(a.Id(d).getName().toLowerCase(),d);this.F=c;c=new og;for(d=0;d<Ac(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.V=c;c={};for(d=0;d<Ac(a,2);d++){var e=a.Id(d);c[B(e,11)]=e}this.Ca=c;c={};for(d=0;d<Ac(a,1);d++)e=B(a,1,d),c[B(e,4)]=e;this.Ha=c;c=[];for(d=0;d<Ac(a,2);d++)pX(a.Id(d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Ac(a,1);d++)pX(B(a,1,d).getName())&&c.push(d);this.O=c;c=[];for(d=0;d<Ac(a,1);d++){e=B(a,1,d).getName();
for(var f=!0,h=0;h<Duc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Duc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Na=c;this.Ya=Euc(a,0);this.$=Euc(a,1);c=[];for(d=0;d<Ac(a,2);d++).8<=B(a.Id(d),6)&&c.push(d);this.va=c;c=[];for(d=0;d<Ac(a,2);d++)e=a.Id(d),.95<=Ec(e,2).length/B(e,8)&&c.push(d);this.cb=c;c=[];for(d=0;d<Ac(a,3);d++){e=a.Id(B(a,3,d));a:if(.5<Ec(e,2).length/B(e,8)||.3>Ac(e,3)/Ac(e,2))e=!1;else{for(f=0;f<Ac(e,10);f++)if(.95<B(e,10,f)/B(e,8)){e=!1;break a}e=!0}e&&c.push(B(a,3,d))}Ub(c);
this.Qa=c;this.H=Fuc(Ac(a,2));this.J=Fuc(Ac(a,1));this.D=new yuc(this.F,this.V,b)}function Fuc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function Euc(a,b){for(var c=[],d=0;d<Ac(a,2);d++)a.Id(d).getType()==b&&c.push(d);return c}function Guc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Huc(c,a[d]);for(a=0;a<b.length;a++)d=Huc(c,b[a]),c=0<d.length?d:c;return c}
function qX(a,b,c,d,e,f,h,k){var l=[a.L,a.D.L],m=[a.H];c&&(m.push(a.Ya),m.push(a.va));d&&m.push(a.Qa);e&&m.push(a.cb);null!=h&&-1!=h?l.push(Auc(a.D.F,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);c=Guc(m,l);return 0<b.length&&(b=b[0].getName())&&(a=a.F.get(b.toLowerCase(),-1),c.includes(a))?a:0<c.length?c[nX(c.length)]:-1}
function rX(a,b,c,d,e,f){var h=[a.O,a.D.O],k=[a.J];c&&k.push(a.Na);null!=e&&-1!=e?h.push(Auc(a.D.V,e)):d&&h.push(a.D.$);f&&h.push(a.D.va);c=Guc(k,h);return 0<b.length&&(b=b[0].getName())&&(a=a.V.get(b.toLowerCase(),-1),c.includes(a))?a:0<c.length?c[nX(c.length)]:-1}function Iuc(a,b){for(var c=5;;){var d=a.C.Id(b),e=nX(Ac(d,2));c--;if(pX(QW(d,e))||0==c)return e}}function Juc(a,b){for(var c=5;;){var d=a.C.Id(b),e=nX(Ac(d,3));e=B(d,3,e);c--;if(pX(QW(d,e))||0==c)return e}}
function sX(a,b){b=a.C.Id(b);a=b.getName();pX(a)||(b=Kuc(Ec(b,7)),a=null==b?a:b);return a}function tX(a,b){b=B(a.C,1,b);a=b.getName();pX(a)||(b=Kuc(Ec(b,2)),a=null==b?a:b);return a}function Kuc(a){for(var b=0;b<a.length;b++)if(pX(a[b]))return a[b];return null}function pX(a){return null==a?!1:50>=a.length}function Luc(a){for(var b=vuc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}
function Huc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Duc=["average","total","sum","mean","median"];function uX(a){this.Qa=a;this.pB=[];this.C=this.Ca=this.va=this.jO=this.sJ=null;this.V=[];this.O=new tg;this.Ha=new tg;this.$=!1;this.F=[];this.D=[]}p=uX.prototype;p.Ie=function(a,b,c,d,e){this.reset();this.sJ=b;this.jO=c;this.va=d;this.Ca=a;this.V=psa?e:[];this.C=new Cuc(a,e)};
p.Uda=function(){if(this.$){var a=tv(ov(this.Qa)),b=Fc(this.C.C,4)?a.top:a.left;a=this.C.Ca[b];b=this.C.Ha[b];a&&Eb(this.F,a);b&&Eb(this.D,b)}a=[];if(psa)for(b=0;b<this.V.length;b++){var c=this.V[b];switch(c.getChartType()){case "BarChart":if(this.Yl(13)||this.Yl(2)){var d=B(c,6);d&&-1!=this.C.F.get(d.toLowerCase(),-1)&&(d=Muc(this,c),1<d.length&&(on&&this.Yl(23)?vX(this,a,"Scatter chart of "+d[0].name+" vs "+d[1].name,23,2):this.Yl(2)&&vX(this,a,"Correlation of "+d[0].name+" and "+d[1].name,2,1.5)))}break;
case "ScatterChart":d=Muc(this,c);1<d.length&&(on&&this.Yl(23)?vX(this,a,"Scatter chart of "+d[0].name+" vs "+d[1].name,23,2):this.Yl(2)&&vX(this,a,"Correlation of "+d[0].name+" and "+d[1].name,2,1.5));break;case "PieChart":d=[];c=ruc(c);for(var e=0;e<c.length&&-1!=this.C.F.get(c[e].name.toLowerCase(),-1);e++)d.push(c[e]);1==d.length&&4==d[0].U7a&&(on&&this.Yl(20)?vX(this,a,"Chart of distribution of "+d[0].name,20,2):this.Yl(14)&&vX(this,a,"Distribution of "+d[0].name,14,1.5))}}this.Yl(1)&&(d=this.C.C,
b=rX(this.C,this.D,!1,!0),c=qX(this.C,this.F,!0,!1,!0,!0,b),-1!=c&&-1!=b&&(d=10<=Ac(d.Id(c),2)?"5 ":"",c=sX(this.C,c),b=tX(this.C,b),c!=b&&vX(this,a,this.$La(1)+" "+d+c+" by "+b,1)));if(this.Yl(2)&&1<Ac(this.C.C,1)){a:if(d=this.C,2>d.J.length)b=[-1,-1];else{c=rX(d,this.D,!1,!1,void 0,!0);if(-1!=c&&(b=Auc(d.D.D,c),0<b.length)){d=[c];c=nX(b.length);d.push(b[c]);b=d;break a}b=Luc(2<=d.O.length?d.O:d.J)}d=b;b=tX(this.C,d[0]);d=tX(this.C,d[1]);b!=d&&vX(this,a,"Correlation of "+b+" and "+d,2)}this.Yl(3)&&
(b=this.C.C,d=rX(this.C,this.D,!0),-1!=d&&vX(this,a,this.xT(Ec(B(b,1,d),3),3)+" of "+tX(this.C,d),3));if(this.Yl(5)){b=this.C.C;d=rX(this.C,this.D,!0,!0);var f=qX(this.C,this.F,!0,!0,!1,!0,d);if(-1!=d&&-1!=f){c=tX(this.C,d);e=b.Id(f);var h=sX(this.C,f);0<Ac(e,3)&&h!=c&&(f=Juc(this.C,f),vX(this,a,this.xT(Ec(B(b,1,d),3),5)+" of "+c+" when "+h+" is "+QW(e,f),5))}}this.Yl(9)&&(d=rX(this.C,this.D,!1,!0),b=qX(this.C,this.F,!0,!1,!0,!0,d),-1!=b&&-1!=d&&(d=tX(this.C,d),b=sX(this.C,b),b!=d&&vX(this,a,b+" with "+
this.Joa(9)+" "+d,9)));this.Yl(10)&&0<Ac(this.C.C,1)&&(b=tX(this.C,rX(this.C,this.D)),vX(this,a,this.Joa(10)+" "+b,10));this.Yl(11)&&(b=this.C.C,d=qX(this.C,this.F,!0,!0,!1,!1,-1),-1!=d&&(c=sX(this.C,d),0<Ac(b.Id(d),3)&&vX(this,a,"Most frequent "+c,11)));if(this.Yl(12)){b=this.C.C;d=rX(this.C,this.D,!0);a:{c=this.C;if(1==c.$.length&&(e=c.$[0],!B(c.C.Id(e),5))){c=e;break a}c=-1}h=c;-1!=h&&-1!=d&&(c=tX(this.C,d),e=b.Id(h),0<Ac(e,2)&&(h=Iuc(this.C,h),vX(this,a,this.xT(Ec(B(b,1,d),3),12)+" of "+c+" "+
Nuc[nX(Nuc.length)]+" "+QW(e,h),12)))}this.Yl(15)&&(b=this.C.C,d=rX(this.C,this.D,!0),h=qX(this.C,this.F,!1,!0,!1,!0,d),-1!=d&&-1!=h&&(c=tX(this.C,d),e=sX(this.C,h),e!=c&&(h=b.Id(h),2<=Ac(h,3)&&(f=vuc(Ac(h,3),2),vX(this,a,"Compare "+this.xT(Ec(B(b,1,d),3),15)+" "+c+" for "+e+" "+QW(h,B(h,3,f[0]))+" and "+QW(h,B(h,3,f[1])),15)))));this.Yl(16)&&(b=qX(this.C,this.F,!0,!0,!1,!1),-1!=b&&(b=sX(this.C,b),vX(this,a,"List unique values in "+b,16)));this.Yl(17)&&(d=this.C.C,b=qX(this.C,this.F,!0,!0,!1,!1),
-1!=b&&(d=d.Id(b),c=sX(this.C,b),1>Ac(d,3)||(b=Juc(this.C,b),vX(this,a,"What percentage of "+c+" is "+QW(d,b),17))));this.Yl(13)&&(b=this.C.C,d=rX(this.C,this.D,!0,!0),e=qX(this.C,this.F,!0,!0,!1,!0,d),-1!=d&&-1!=e&&(c=tX(this.C,d),e=sX(this.C,e),e!=c&&vX(this,a,this.xT(Ec(B(b,1,d),3),13)+" of "+c+" by "+e,13)));on&&this.Yl(18)&&(b=rX(this.C,this.D),-1!=b&&vX(this,a,"Histogram of "+tX(this.C,b),18,2));((b=3>a.length)||0==nX(5))&&this.Yl(7)&&(c=this.C.C,h=rX(this.C,this.D,!1,!0),d=qX(this.C,this.F,
!1,!1,!1,!0,h),-1!=d&&-1!=h&&(c=c.Id(d),e=sX(this.C,d),h=tX(this.C,h),0<Ac(c,2)&&e!=h&&(d=Iuc(this.C,d),vX(this,a,"Show "+h+" for "+e+" "+QW(c,d),7))));if((b||0==nX(5))&&this.Yl(8)){b=this.C.C;a:if(e=this.C,2>e.H.length)d=[-1,-1];else{c=qX(e,this.F,!0,!1,!1,!1,void 0,!0);if(-1!=c&&(d=Auc(e.D.C,c),0<d.length)){c=[c];e=nX(d.length);c.push(d[e]);d=c;break a}d=Luc(2<=e.L.length?e.L:e.H);d[0]!=c&&(d[1]=d[0],d[0]=c)}c=d;d=c[0];1<Ac(b,2)&&-1!=d&&(c=c[1],b=b.Id(c),e=sX(this.C,c),d=sX(this.C,d),0<Ac(b,2)&&
e!=d&&(c=Iuc(this.C,c),vX(this,a,"What is "+d+" where "+e+" is "+QW(b,c),8)))}this.pB=Ouc(a)};p.reset=function(){this.pB=[];this.D=[];this.F=[];this.Ha=new tg;this.O=new tg};p.Vda=function(){return Hi(this.pB.slice())};function Ouc(a){Ub(a,function(a,c){return c.weight-a.weight});return vb(a,function(a){return a.pxa})}function vX(a,b,c,d,e){e=a.YLa(d,void 0===e?1:e);a.Ha.contains(c)||(b.push({pxa:{query:c,ep:void 0,type:d},weight:e}),a.O.add(d),a.Ha.add(c))}p.Yl=function(a){return!this.O.contains(a)};
function Puc(a,b){return a.Vda().then(function(a){return a.length<=b?a:Pb(a,0,b)},null,a)}function Muc(a,b){var c=[];b=ruc(b);for(var d=0;d<b.length&&-1!=a.C.V.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}p.xT=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=Quc;break a;case 4:a=Ruc;break a}a=Suc}return a[nX(a.length)]};p.$La=function(){return Tuc[nX(Tuc.length)]};p.Joa=function(){return Uuc[nX(Uuc.length)]};
var Suc=["Average","Median"],Quc=["Total","Average","Median"],Ruc=["Median"],Uuc="Minimum Maximum Most Least Highest Lowest".split(" "),Tuc=["Top","Bottom"],Nuc=["before","after"];function Vuc(a,b,c){uX.call(this,a);this.J=[];this.L=this.H=null;this.Na=b;this.Jb=c;this.Ya=zi(new yi,10).build()}ha(Vuc,uX);p=Vuc.prototype;p.Uda=function(){this.reset();uX.prototype.Uda.call(this);osa&&Wuc(this)};p.reset=function(){uX.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.Vda=function(){return osa&&this.H?this.H.then(function(){return this.J.slice()},null,this):uX.prototype.Vda.call(this)};p.YLa=function(a,b){return Math.pow(Math.random(),1/(Xuc(a)*b))};
p.dg=ca("L");function Xuc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}
function Wuc(a){var b=null;a.H=new Fi(function(a){if(!this.L||3<=this.L.getStatus().getState().C)this.J=this.pB,a();var c=gw(this.sJ.rect),e=vb(this.pB,function(a){return a.query});c=Wk(Vk(Yj(ak(bk(this.L.yf("/answers/parsesuggestions").Yf("gid",this.sJ.Yc,"range",c),t(function(b){Yuc(this,b).then(a)},this)),t(function(b){8==b.errorCode&&this.Jb.hc(2833,this.Ya);this.J=this.pB;a()},this)).setContent(["queries",Si(e)]).setTimeout(2E3),1)),"POST");un&&this.jO&&null!=this.va&&(e=0==this.jO.rect.width||
0==this.jO.rect.height?"":gw(this.jO.rect),c.Yf("headerRange",e,"tableRecordDimension",""+this.va));b=c.Re()},a);Mi(a.H,function(){b&&b.dispose()})}function Yuc(a,b){return a.Na.C.D.Xd.then(function(){var a=[];if(b.Vl())for(var d=b.Kf(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.Ca&&!!B(this.Ca,4),f=Zuc(this.Na,d[e],this.sJ,f),f=$uc(f);f&&(this.pB[e].ep=d[e],a.push(this.pB[e]))}this.J=a},function(){this.J.length=0},a)};function avc(a,b,c){this.J=a;this.D=[];this.C=[];this.F=b;this.H=c}u(avc,D);function wX(a,b){xX(a);bvc(a,b)}function bvc(a,b){if(null!=b){var c=lB(a.J);b=b.rect;if(wh(b)&&0!=b.width&&0!=b.height){var d=llb(c,b,a.H);F(a,d);d.setVisible(!0);a.D.push(d);c=ZH(c,b,a.F,1,0);F(a,c);c.setVisible(!0);a.C.push(c)}}}function xX(a){Ic(a.D);Ic(a.C);a.D=[];a.C=[]};var cvc={};ac({S6a:{type:0,rB:"",nB:[]},SUM:{type:1,rB:"Sum",nB:[3,5,13,12,15]},AVERAGE:{type:2,rB:"Average",nB:[3,5,13,12,15]},iia:{type:3,rB:"Mode",nB:[3]},f7a:{type:4,rB:"Variance",nB:[3]},k6a:{type:5,rB:"Standard deviation",nB:[3]},MEDIAN:{type:6,rB:"Median",nB:[3,5,13,12]},COUNT:{type:7,rB:"Count",nB:[]},f6a:{type:8,rB:"Bottom",nB:[1,10,14]},g6a:{type:9,rB:"Top",nB:[1,11,10,14]}},function(a){cvc[a.type]=a});function dvc(a){if(a=cvc[a])return a};function evc(a){uX.call(this,a);this.H=[]}ha(evc,uX);p=evc.prototype;p.reset=function(){uX.prototype.reset.call(this);this.H=[]};p.YLa=n(1);p.Yl=function(a){return!this.O.contains(a)&&0<fvc(this,a).length};p.$La=function(a){return gvc(this,a)};p.xT=function(a,b){return gvc(this,b)};p.Joa=function(a){return gvc(this,a)};function hvc(a,b){a.reset();x(b,function(b){x(Ec(b,1),function(b){a.H.push(B(b,1))},a)},a);xuc(a.H);a.Uda();return Puc(a,3)}
function fvc(a,b){return ub(a.H,function(a){return Bb(dvc(a).nB,b)},a)}function ivc(a,b){a=zb(a.H,function(a){return dvc(a).type==b},a);return dvc(a)}function gvc(a,b){b=fvc(a,b);return ivc(a,b[nX(b.length)]).rB};var jvc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),kvc=[{pk:["Thank you","Thankyou","Thanks"],Ug:"No problem"},{pk:["you are amazing","This is great","omg"],Ug:"Happy to help"},{pk:["I love you"],Ug:"Must be in the air"},{pk:["How do you know","How are you so smart"],Ug:"It's all in the data"},{pk:["Are you sure"],Ug:"Send feedback if this doesn't seem correct to help improve accuracy"},{pk:["How are you"],Ug:"Pretty good, thanks"},
{pk:["Hi","Hello","Hey"],Ug:"Hi, there. Try asking a question about your data."},{pk:["You are stupid","This is dumb","You are wrong"],Ug:"Help improve this experience by sending feedback"},{pk:["How smart are you"],Ug:"Pretty smart"}];function lvc(a){for(var b=0;b<kvc.length;++b)if(-1!=Ab(kvc[b].pk,function(b){return Qa(a,b)}))return b;return-1};function mvc(a,b,c,d){var e=new Usc;N(e,2,c);x(b,function(a){ei(e,1).push(a)});N(e,3,d);d=new RW;N(d,1,a);N(d,3,b[c]);ji(d,11,e);return d}function nvc(a,b,c,d){var e=new Wsc;N(e,2,c);x(b,function(a){ei(e,1).push(a)});N(e,3,d);d=new RW;N(d,1,a);N(d,2,b[c]);ji(d,10,e);return d}function ovc(a){var b=new Xsc;x(a,function(a){var c=a.type;ei(b,1).push(c);a.uKa&&(a=a.uKa,ei(b,2).push(a))});return b}function pvc(a){var b=new Vsc;x(a,function(a){a=a.type;ei(b,1).push(a)});return b}
function qvc(a,b,c,d){var e=new Tsc;a&&N(e,1,a);b&&N(e,2,b);for(a=0;a<c.length;a++)b=c[a],ei(e,3).push(b);N(e,4,d);return e};function yX(a,b){this.D=a;this.C=b}yX.prototype.getChartType=g("D");var zX={2:new yX("ColumnChart","Column chart"),3:new yX("LineChart","Time series"),4:new yX("ScatterChart","Scatter chart"),5:new yX("PieChart","Pie chart"),10:new yX("Histogram","Histogram"),7:new yX("LineChart","Line chart")};function AX(a,b,c,d,e,f,h){this.D=a;this.p_=b;this.H=(void 0===h?null:h)||b;this.C=d;this.ep=c;this.Na=d?Ec(d,6):[];this.Qa=d?Ec(d,7):[];this.Ha=d?Ec(d,8):[];this.error=e||1;this.interpretation=d&&zc(d,4)?B(d,4):null;this.O=d?Ec(d,12):[];this.Ca=d?Ec(d,21):[];this.va=f;this.F=null;this.$=this.J=!1;this.L=[];this.V=null;on&&rvc(this)}function svc(a){return 1==a.error&&null!=a.ep}
function tvc(a){return{YO:uvc(a),interpretation:a.interpretation,p_:a.p_,ep:a.ep,v3:1<a.p_.length&&1<a.p_[0].length,Ql:a.Ql(),wYb:a.$,O2:a.O2(),iLb:a.L}}AX.prototype.Ql=function(){return on&&null!=this.F&&(this.F in zX?!0:!1)&&2<this.H.length};AX.prototype.O2=function(){return nn&&Ig(K(),"feapt")&&null!==this.C&&zc(this.C,24)};AX.prototype.getChartType=function(){if(!this.Ql())return null;var a=this.F;if(a in zX)return zX[a].getChartType();throw Error("Unknown chart type.");};
function vvc(a){a.Ql();return a.H[0][0]}function wvc(a){return vb(Ec(a.C,22),function(b){if(B(b,2)){var c=a.va.C;return ew(B(b,2),c)}},a)}function xvc(a){return{YO:uvc(a),error:yvc(a)}}function zvc(a,b,c){var d=c.length;if(0==d)return a;1<d&&Jb(a,10);c=B(c[0],1);2<d&&9==c&&Jb(a,4);2<d&&Jb(a,5);2!=c&&3!=c&&12!=c&&Jb(a,3);Bb(b,10)&&Bb(a,10)&&Vaa(a,function(a){return 10!=a});return a}
function rvc(a){var b=null;a.J=!1;a.F=null;if(a.C&&zc(a.C,17)){var c=B(a.C,17);a.$=B(c,4)||!1;var d=Ec(c,3),e=zvc(Ec(c,1),d,Ec(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=ub(e,function(a){return Bb(d,a)}),c=ub(d,function(a){return!Bb(e,a)}),Jb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):Bb(d,10)&&Bb(e,2)?(a.J=!0,a.F=2,Jb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=Avc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=Avc(a,e),a.J=B(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.V=qvc(a.F,b,e,a.J))}}function Avc(a,b){if(!Ec(a.C,18).length)return b[0];a=Bvc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(Bb(b,a[c]))return a[c];return b[0]}function Cvc(a,b,c){var d={};null!=b?(d.v=Dvc(a,b,c),d.f=b):d.v=null;return d}
function Bvc(a){for(var b=new xC,c=a.H[0],d=Pb(a.H,1),e=Ec(a.C,18),f=[],h=0;h<c.length;h++)null!=e[h]&&zc(e[h],1)?f.push(Evc(B(e[h],1))):f.push(0==h?"string":"number"),b.Dt({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(Cvc(a,d[e][k],f[k]));b.vx(h)}return b}
function Dvc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return b=b||"0",a=UJa(a.va.L.C).DECIMAL_SEP,b=b.replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),pb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Wa(a[0])&&Wa(a[1])&&(Wa(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Wa(a[d])&&
(c[d]=pb(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function Evc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function Fvc(a){if(!zc(a.C,9))return"";if(zc(a.C.getError(),3))switch(B(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Em()||""}
function yvc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return Fvc(a)||"Sorry, couldn't understand your question.";case 7:return a=lvc(a.D),-1!=a?kvc[a].Ug:""}return""}
function uvc(a){var b=[];if(svc(a)){var c=[];x(Lb(a.Na,a.Ha),function(a){c.push(Gvc(a,"waffle-assistant-answercard-question-unused-phrase"))});x(a.Qa,function(a){c.push(Gvc(a,"waffle-assistant-answercard-question-used-entity"))});Ub(c,function(a,b){return a.mB>b.mB?1:-1});var d=0;x(c,function(c){var e=c.length,h=c.mB;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.rl}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function Gvc(a,b){return{mB:B(a,2),length:B(a,3),rl:b}};function BX(a,b,c,d){I.call(this);this.V=a;this.O=b;this.va=c;this.Qa=d;this.Ra=new J(this);F(this,this.Ra);this.C=new IV;F(this,this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.$=!1;lpc(this.C,this.V);this.C.Ca=10;this.C.hb=!0;this.C.O=!1;this.C.IXa("waffle-assistant-visible");this.C.va=Xa("waffle-assistant-dragged-formula").split(" ");this.C.Ie();this.Ra.R(this.C,epc,this.Ha).R(this.C,hpc,this.Na).R(this.C,ipc,this.Ca)}u(BX,I);BX.prototype.Ze=ca("$");
BX.prototype.Ha=function(a){a=sb(this.V.childNodes,a.C);this.L=this.J[a]};
BX.prototype.Na=function(a){var b=a.event instanceof sq?a.event.sN:a.event;this.$?(a.J.nA(b,!0),a.preventDefault()):(Qp(a.F,a.event.clientX,a.event.clientY),a=Rp(a.F),b=lB(this.O).pe(),dh(jG(b,"page",!1,!1)).contains(a)?(a=gG(b,a.x,a.y,"page"),(b=cx(ov(this.va),a.y,a.x))?a=new Sg(b.qc(),b.tc()):b=ih(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=lB(this.O),G(this.D),this.D=Vjc(a,b,"waffle-assistant-formula-insertion-rect"),F(this,this.D),$G(uI(a),this.D),G(this.F),this.F=ZH(a,b,"waffle-assistant-formula-insertion-border",
2,0),F(this,this.F),ghb(this.F,"#000"),this.F.setVisible(!0))):Hvc(this))};BX.prototype.Ca=function(a){if(this.H){nI(lB(this.O),!1);var b=this.H,c=ov(this.va);b=new CG(c,b,this.L);this.Qa.C(b);this.dispatchEvent(new H("formula_inserted"))}a.J.nA(null,!0);a.preventDefault();this.L="";Hvc(this)};function Hvc(a){a.H=null;G(a.D);a.D=null;G(a.F);a.F=null};function Ivc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(Zt({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=U(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(b)+"</div>";
return V(a+"</div></div>")};function Jvc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Kvc({YO:a.jC.YO}),d=a.jC.p_;var e=a.jC.ep;var f=a.jC.interpretation,h=a.jC.v3,k=a.jC.Ql,l=a.jC.wYb,m=a.jC.O2;a=a.jC.iLb;null==d||Ca(d);Ca(a);var r=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Sr("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){if(!l){k&&(r+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>');r+='<div class="waffle-assistant-answercard-answer">';if(h){r+='<div class="waffle-assistant-answercard-answer-rowheader">';l=d[0];f=l.length;for(var v=0;v<f;v++)r+='<span class="waffle-assistant-answercard-answer-col">'+
U(l[v])+"</span>";r+="</div>"}r+='<div class="waffle-assistant-answercard-answer-rows">';l=Or("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=d.length;for(v=0;v<f;v++){var w=d[v];if(h&&0==v)w="";else{var z=l;Ca(w);z='<div class="'+W(z)+'">';for(var A=w.length,E=0;E<A;E++){var M=w[E];z=M?z+('<span class="waffle-assistant-answercard-answer-col">'+U(M)+"</span>"):z+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>')}w=V(z+"</div>")}r+=w}r+="</div></div>"}r+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':"";m&&(r+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>')}if(0<a.length){r+='<div class="waffle-assistant-answercard-info-msgs">';d=a.length;for(h=0;h<d;h++)r+='<div class="waffle-assistant-answercard-info-msg">* '+U(a[h])+
"</div>";r+="</div>"}r+='<div class="waffle-assistant-answercard-footer">';k&&(r+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');r+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
U(Zt({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(e)+"</div></div></div></div></div></div></div></div>";e=V(r);return b(c+e+"</div></div>")}
function Kvc(a){Ca(a.YO);a=a.YO;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Sr("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function Lvc(){var a=V;var b=V('<div class="waffle-assistant-answers-card-remove">'+U(Zt({icon:"docs-icon-img docs-icon-trash"}))+"</div>");return a(U(b))};function Mvc(a){this.Jb=a}function Nvc(a,b){var c=new SW;N(c,3,b);N(c,8,Hsa);b=new LT;ji(b,4,c);c=new pi;ji(c,46,b);c=Ai(zi(new yi,10),c).build();a.Jb.hc(2753,c)};function Ovc(a,b,c,d,e,f){H.call(this,"sqc");this.V=a;this.F=f||"";this.L=b;this.J=d;this.$=e;this.C=c}u(Ovc,H);function Pvc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;H.call(this,"answers-submit-query");this.C=a;this.V=b;this.L=c;this.J=d;this.$=e;this.F=f;this.va=h}u(Pvc,H);function CX(a,b,c,d,e,f,h,k,l,m,r){fX.call(this,new jv,r);this.C=a;this.Wf=wvc(a);this.Xb=a.Ql();this.Ld=a.O2();this.wc=a.Ql()&&a.J;this.Ub=a.$;this.Ya=!1;this.re=b;this.vd=c;this.Wc=d;this.jg=h;this.Jb=e;this.Xe=f;this.Ke=k;this.rf=m;this.Ic=zi(new yi,10).build();this.Ob=new Hs("",new cX,this.xa());this.Ta(this.Ob);this.L=null;this.J=new Hs("",new bX,this.xa());this.Ta(this.J);this.Ca=new Hs("",new bX,this.xa());this.Ta(this.Ca);this.Ha=new Hs("",new cX,this.xa());this.Ta(this.Ha);this.H=new uU;
this.Ta(this.H);this.va=new HH("");this.Ta(this.va);this.F=null;this.zc=Bvc(this.C);this.cb=new avc(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");F(this,this.cb);this.pb=!1;this.Qa=new Hs("",new cX,this.xa());this.Ta(this.Qa)}u(CX,fX);p=CX.prototype;p.coa=g("Ke");p.Da=function(){CX.ea.Da.call(this);ytc(this).appendChild(S(Lvc))};
p.Sa=function(){CX.ea.Sa.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.Ob.ob(a);dX(a,"Remove card",0);this.getHandler().Kc(this.Ob,"action",this.n4b).R(this.J,"action",this.EFb).R(this.Ca,"action",this.axb).Kc(this.J,"action",t(this.PSa,this,!0)).Kc(this.Ca,"action",t(this.PSa,this,!1))};
p.jF=function(a){gX(this).appendChild(S(Jvc,{jC:tvc(this.C)}));this.J.ob(this.$a("waffle-assistant-answercard-see-formula-link"));this.Ca.ob(this.$a("waffle-assistant-answercard-hide-formula-link"));this.L=new BX(this.$a("waffle-assistant-answercard-formula-text-container"),this.re,this.vd,this.Wc);this.L.Ze(this.Gd());this.L.J=[this.C.ep];F(this,this.L);var b=this.$a("waffle-assistant-answercard-formula-text");yp(b,"Formula: "+(this.C.ep+". Click/Press ENTER to copy or drag to insert on to sheet."));
this.getHandler().Kc(this.L,"formula_inserted",this.XMb).Yh(this.$a("waffle-assistant-answercard-formula-text"),hd,this.nwb);Qvc(this,this.rf);Rvc(this);if(this.Xb){if(this.Ub)Svc(this,this.C.getChartType()),this.Ya=!0;else{this.H.ob(this.$a("waffle-assistant-answercard-tabs"));b=new sU("");b.ob(this.$a("waffle-assistant-answercard-formula-tab"));this.H.Ta(b);var c=new sU("");c.ob(this.$a("waffle-assistant-answercard-chart-tab"));this.H.Ta(c);this.getHandler().R(this.H,"select",this.UHb).Kc(b,"action",
t(this.NSa,this,0)).Kc(c,"action",t(this.NSa,this,1));this.H.Sw(this.wc?c:b)}b=Ec(B(this.C.C,17),1);for(c=0;c<b.length;c++)this.va.Nd(Tvc(b[c]));this.va.ob(this.$a("waffle-assistant-answercard-chart-type-select"));Dt(this.va,Tvc(this.C.F));b=this.$a("waffle-assistant-answercard-insert-chart");this.Ha.ob(b);Uvc(this);this.getHandler().R(this.Ha,"action",this.m4b).R(this.va.Dc(),"action",this.Qqb)}this.Ld&&(b=this.$a("waffle-assistant-answercard-insert-pivot"),this.Qa.ob(b),this.getHandler().R(this.Qa,
"action",this.eyb));a()};p.Ffa=function(){return this.Xb&&!this.Ub&&!this.wc};function Tvc(a){if(a in zX)return new qr(zX[a].C,a);throw Error("Unknown chart type.");}p.Qqb=function(a){a=a.target.ib();if(a in zX)Svc(this,zX[a].getChartType());else throw Error("Unknown chart type model.");};
function Svc(a,b){a.F=new cv;C(a.F,1,b);C(a.F,2,a.C.interpretation||"");if("Histogram"===b)b=vvc(a.C),C(a.F,3,b),C(a.F,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.zc.ad(0)&&(b=a.zc.zg(0),C(a.F,3,b),b=1),1==a.zc.getNumberOfColumns()-b?(b=a.zc.zg(b),C(a.F,6,b)):C(a.F,6,"Values");else{b=a.F;var c=vvc(a.C);C(b,3,c);c=a.C;c.Ql();C(b,6,c.H[0][1]||"")}b=Otc(a.F);b.we(a.zc);c=a.$a("waffle-assistant-answercard-chart");b=Ptc(b,c);tV(b,b.Ed());b.setOption("title","");GV(b,c,a.Jb,qn);
a.Ya=!0}p.eyb=function(){var a=ov(this.vd),b=this.C;b.O2();b=b.C?B(b.C,24):null;a=a.yc();b=zSa(b,a,new Sg(0,0),0);this.Wc.C(new xqc(b,a))};p.m4b=function(){if(this.F){var a=Otc(this.F);a.we(this.zc);tV(a,a.Ed());var b=this.O,c=this.zc,d=this.C.F,e=new Rsc;N(e,1,d);d=new SW;ji(d,11,e);e=new LT;ji(e,4,d);d=new pi;ji(d,46,e);this.dispatchEvent(new ptc(a,b,c,2874,void 0,void 0,d))}};p.dF=function(){yp(this.La,"Answer Card for question: "+this.C.D)};p.iF=Wf;p.XC=n("assistantAnswersFeedback");p.uH=n(2628);
p.tH=n(2627);p.Kaa=n("Was this answer correct?");p.Zoa=n("Correct");p.Yoa=n("Incorrect");p.VP=g("C");p.Ze=function(a){CX.ea.Ze.call(this,a);this.L&&this.L.Ze(a);Rvc(this);Uvc(this)};p.E2=function(){CX.ea.E2.call(this);if(!this.pb){var a=this.cb,b=this.Wf;xX(a);for(var c=0;c<b.length;c++)bvc(a,b[c]);this.pb=!0}};p.WU=function(){CX.ea.WU.call(this);xX(this.cb);this.pb=!1};p.UHb=function(){switch(BU(this.H)){case 0:Vvc(this,!1);break;case 1:Vvc(this,!0);break;default:BU(this.H)}};
function Vvc(a,b){Q(a.$a("waffle-assistant-answercard-chart-container"),b);Q(a.$a("waffle-assistant-answercard-answer"),!b);Q(a.$a("waffle-assistant-answercard-formula-holder"),!b);Uvc(a);!a.Ya&&b&&Svc(a,a.C.getChartType())}function Rvc(a){var b=a.Fb("waffle-assistant-answercard-formula-help");b&&Q(b,!a.Gd())}function Uvc(a){var b=(a.Ub||1==BU(a.H))&&!a.Gd();a.Ha.setVisible(b)}
function Qvc(a,b){a.J.setVisible(!b);a.Ca.setVisible(b);Q(a.$a("waffle-assistant-answercard-formula"),b);b?a.$a("waffle-assistant-answercard-formula-text").focus():(a.J.La.focus(),a.J.yq(!0))}p.n4b=function(){Nvc(this.Xe,!0);this.dispatchEvent(new H("rc"))};p.EFb=function(){Qvc(this,!0)};p.axb=function(){Qvc(this,!1)};p.PSa=function(a){var b=new SW;N(b,9,a);a=new LT;ji(a,4,b);b=new pi;ji(b,46,a);b=Ai(zi(new yi,10),b).build();this.Jb.hc(2849,b)};
p.NSa=function(a){var b=this.C.V,c=new Ssc;ji(c,1,b);switch(a){case 0:N(c,2,2);break;case 1:N(c,2,1);break;default:N(c,2,0)}a=new SW;ji(a,10,c);c=new LT;ji(c,4,a);a=new pi;ji(a,46,c);c=Ai(zi(new yi,10),a).build();this.Jb.hc(2850,c)};p.XMb=function(){this.Jb.hc(2709,this.Ic)};
p.nwb=function(){var a=this.xa().Tb(),b=a.createElement("textarea");b.textContent=this.C.ep;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(DX(this.jg,"Formula copied to clipboard",this.xa()),this.Jb.C(35534,this.Ic))};function Wvc(a){var b=a.type;if(!q(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return q(a.value)?a.value:null}}
function Xvc(a,b){var c=a.type;if(q(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(qa(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":qa(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function Yvc(){this.F=[];this.D={};this.J=null;this.C=new sO}function Zvc(a,b,c,d){function e(a){return a.toLowerCase()}Rb(b,void 0,e);Rb(c,void 0,e);Rb(d,void 0,e);x(b,a.H,a);x(c,a.H,a);x(d,a.H,a)}Yvc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function $vc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Yvc.prototype.dJ=function(a,b,c){if(Xa(a||"")){var d=this.J.Xm();d=awc(this,a.substring(0,d));var e=bwc(this,b-d.length,a);d=Lb(d,e)}else d=bwc(this,b);d.length>b&&(d=Pb(d,0,b));c(a,d)};
function bwc(a,b,c){var d=c||"";c=bc(a.D,function(a){return Qa(a,d)});var e=cwc(gc(c),d?1:2,1);a=ub(a.F,function(a){return Qa(a.query,d)&&!e[a.query.toLowerCase()]});b=cwc(a,b-fc(e),2);b=gc(b);var f=vb(b,function(a,b){a.qxa=b;return a.oZa});x(b,function(a){a.oxa=f});return Lb(b,gc(e))}
function awc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={dga:h.dga,U3:h.U3,RV:h.RV},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.RV={};h.U3=0;h.dga=f.substr(k);var l=a.C.Ne(h.dga);x(l,function(b){return function(c){var d=c.length-b.dga.length;b.U3=Math.max(d,b.U3);c=a.C.get(c);b.RV[d]||(b.RV[d]=[]);Ob(b.RV[d],c)}}(h));for(l=0;l<=h.U3&&0<d;++l){var m=h.RV[l];if(m)for(var r=0;r<m.length&&0<d;++r){var v=m[r];cb(b.toLowerCase(),v.toLowerCase())||e[v]||(--d,c.push({text:v,ep:"",
oB:0,LFa:f.length-k,oZa:void 0,oxa:[],qxa:-1}),e[v]=!0)}}}return c}function cwc(a,b,c){b=vuc(a.length,Math.min(a.length,b));var d={};x(b,function(b){b=a[b];var e=qa(b)?b:b.query;d[e.toLowerCase()]={text:e,ep:qa(b)?"":b.ep,oB:c,LFa:0,oZa:qa(b)?void 0:b.type,oxa:[],qxa:-1}});return d};function EX(){OG.call(this,"",null,!1)}u(EX,OG);EX.prototype.uE=function(a,b){if(2==a.oB||1==a.oB)return EX.ea.uE.call(this,a.text,b);var c=this.Xa(),d=this.Xm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.LFa)+a.text;e||(f+=" ");a=EX.ea.uE.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.Bk;b.blur();b.focus();this.U4(f.length);return a};
EX.prototype.Gg=function(a){var b=EX.ea.Gg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,Ofb(b)&&b.HH()&&a.preventDefault(),b=!0);return b};function dwc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(Zt({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(Zt({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(Zt({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function ewc(a){this.qb=a||Rl()}
ewc.prototype.Mw=function(a,b,c){b=S(dwc);var d=this.qb.$a("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.qb.nf(d,a.text);d=this.qb.$a("waffle-assistant-answers-ac-entity-icon",b);var e=this.qb.$a("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.qb.$a("waffle-assistant-answers-ac-session-query-icon",b);Q(d,0==a.oB);Q(e,2==a.oB);Q(f,1==a.oB);d="";switch(a.oB){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Bp(c,d);this.qb.appendChild(c,b)};function fwc(a,b,c,d){R.call(this,d);this.F=new Hs("",new cX,this.xa());this.Ta(this.F);this.V=new OV(!1,"#4285f4");this.Ta(this.V);this.J=new EX;this.J.xKa=!0;this.J.Na=!0;F(this,this.J);this.O=b;this.O.J=this.J;b=new MG(null,new ewc(d));this.D=new IG(this.O,b,this.J);F(this,this.D);this.Jb=a;this.L=!1;this.va=zi(new yi,c).build();this.H=this.xc=this.C=this.$=null}ha(fwc,R);p=fwc.prototype;
p.Sa=function(){R.prototype.Sa.call(this);var a=this.D.Be();a.className="waffle-assistant-answers-ac-renderer";a.dP="waffle-assistant-answers-ac-row";a.t8="waffle-assistant-answers-ac-active";a.Zra="waffle-assistant-answers-ac-highlighted";this.J.C=this.D;this.D.x_=!1;this.D.Gda=6;this.getHandler().R(this.D,"update",this.mpb)};
p.zd=function(a){R.prototype.zd.call(this,a);var b=this.xa();this.xc=a;this.H=b.$a("waffle-assistant-answers-query-box",a);this.F.ob(b.$a("waffle-assistant-answers-clear-query-button",this.H));this.$=b.$a("waffle-assistant-answers-spinner-container",this.H);this.V.render(this.$);this.C=b.$a("waffle-assistant-answers-input-box",this.H);cgb(this.J,this.C);dX(this.F.getElement(),"Clear query");gwc(this,this.getHandler());this.F.setVisible(!1)};p.Ka=function(){R.prototype.Ka.call(this);this.O.J=null};
p.setVisible=function(a){this.xc&&(Q(this.xc,a),(a=Vu)&&a.dispatchEvent("resize"))};function hwc(a,b,c){c=void 0===c?!1:c;Xvc(a.C,b);c&&a.C.focus();a.o_a()}function gwc(a,b){b.R(a.H,"submit",a.KNb).R(a.H,"focus",function(){return iwc(a,!0)},!0).R(a.H,"blur",function(){return iwc(a,!1)},!0).R(a.F,"action",a.X9a).R(a.C,"input",a.o_a).R(a.C,"focus",a.MWa)}
p.mpb=function(a){a.row&&(a=a.row,2==a.oB?(jwc(this,1,a.oxa,a.qxa,a.ep,2),this.Jb.hc(2652,this.va)):0==a.oB?(this.L=!0,this.Jb.hc(2651,this.va)):1==a.oB&&jwc(this,3))};function iwc(a,b){Gp(a.H,"waffle-assistant-answers-query-box-focused",b);a.D.Rf()&&!b&&a.D.Ii()}p.o_a=function(){this.F.setVisible(!!Wvc(this.C))};p.MWa=function(){this.D.Tw(this.C);var a=ib(Wvc(this.C));this.J.U4(a.length);Lfb(this.D,a||"  ");this.D.update(!0)};p.KNb=function(a){a.stopPropagation();a.preventDefault();jwc(this,2)};
function jwc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Xa(Wvc(a.C));a.F.setVisible(!!h);kwc(a);a.dispatchEvent(new Pvc(b,h,a.L,c,d,e,f));a.L=!1}p.X9a=function(){Xvc(this.C,"");this.F.setVisible(!1)};function lwc(a,b){Q(a.$,b);Q(a.xa().$a("waffle-assistant-answers-button-container",a.H),!b);a.V.setActive(b)}function kwc(a){a.C.blur();a.D.Rf()&&a.D.Ii()};function mwc(){var a=Or("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(Zt({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function nwc(a){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(Kvc({YO:a.HJa.YO}))+U(Ivc({error:a.HJa.error,showHelp:a.showHelp}))+"</div></div>")}function owc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function FX(a,b,c,d,e){fX.call(this,new jv,e);this.H=a;this.va=b;this.L=d;this.Ca=c;this.J=new Hs("",new cX,this.xa());this.Ta(this.J);this.C=new Hs("",new bX,this.xa());this.Ta(this.C);this.F=new Hs("",new bX,this.xa());this.Ta(this.F)}u(FX,fX);p=FX.prototype;p.dF=function(){yp(this.La,"Error Card for question: "+this.H.D)};p.XC=n("assistantAnswersFeedback");p.iF=Wf;p.yca=Vf;p.Da=function(){FX.ea.Da.call(this);ytc(this).appendChild(S(Lvc))};
p.Sa=function(){FX.ea.Sa.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.J.ob(a);this.F.setVisible(this.L);dX(a,"Remove card",0);this.getHandler().Kc(this.J,"action",this.t4b).Kc(this.C,"action",this.PFb).R(this.F,"action",this.s4b)};
p.jF=function(a){gX(this).appendChild(S(nwc,{HJa:xvc(this.H),showHelp:this.L}));if(jn){var b=S(owc);this.xa().appendChild(this.La,b);this.C.ob(this.$a("waffle-assistant-answercard-feedback-link"))}this.L&&this.F.ob(this.$a("waffle-assistant-answers-helpcenter-link"));a()};p.coa=g("va");p.VP=g("H");p.PFb=function(){this.C.setVisible(!1);Q(this.$a("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new H("trigger_feedback"))};p.t4b=function(){Nvc(this.Ca,!1);this.dispatchEvent(new H("rc"))};
p.s4b=function(){O.Ro.Ac()};function pwc(a){fX.call(this,new jv,a);this.C=this.xa().createElement("div");tm(this.C,"Previous")}u(pwc,fX);p=pwc.prototype;p.dF=function(){yp(this.La,"Previous questions below")};p.Da=function(){pwc.ea.Da.call(this);Ep(this.La,"waffle-assistant-card");Bp(this.La,"waffle-assistant-answers-previousheadercard")};p.jF=function(a){0<this.xa().xi(gX(this)).length||gX(this).appendChild(this.C);a()};p.yca=Vf;p.XC=n("assistantAnswersFeedback");function qwc(a){var b=""+((a.G$?U(Ivc({error:a.G$,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":""));var c=Or("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.pB;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(Zt({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+U(f)+"</div></div></div>"}return V(b+"</div>")};function GX(a,b,c,d,e,f){fX.call(this,a,f);this.C=e||null;this.va=b;this.F=d;this.Ca=c;this.L=this.C?5==this.C.error:!1;this.H=new Hs("",new bX,this.xa());this.Ta(this.H);this.J=new Hs("",new cX,this.xa());this.Ta(this.J)}u(GX,fX);p=GX.prototype;p.Da=function(){GX.ea.Da.call(this);this.iF()&&ytc(this).appendChild(S(Lvc))};
p.Sa=function(){GX.ea.Sa.call(this);Bp(this.La,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.u4b);if(this.iF()){var a=this.$a("waffle-assistant-answers-card-remove");this.J.ob(a);dX(a,"Remove card",0);this.getHandler().Kc(this.J,"action",this.v4b)}};p.uH=function(){return Bb([rwc,HX],this.F)?2799:Bb([swc,twc],this.F)?2801:null};p.tH=function(){return Bb([rwc,HX],this.F)?2798:Bb([swc,twc],this.F)?2800:null};p.Kaa=n("Were these interesting?");
p.Zoa=n("Interesting");p.Yoa=n("Not interesting");p.XC=n("assistantAnswersFeedback");p.iF=function(){return this.C?!svc(this.C):!1};p.dF=function(){var a=this.F.title;a&&this.C?yp(this.La,a+(" for question : "+this.C.D)):yp(this.La,"Suggested questions")};
p.jF=function(a){var b=this;this.Ca.then(function(c){if(b.gc()){if(0==c.length)Q(b.La,!1);else{var d=b.xa(),e=gX(b);if(0==d.xi(e).length){var f=S(qwc,{title:b.F.title,pB:vb(c,function(a){return a.query}),G$:b.C?yvc(b.C):"",showHelp:b.L});e.appendChild(f);var h=vb(c,function(a){return a.type});e=b.Zi("waffle-assistant-answercard-question-container");x(e,function(a,e){var f=new Hs("",new cX,d);b.Ta(f);f.ob(a);b.getHandler().R(f,"action",t(b.GHb,b,c[e],h,e))});b.L&&b.H.ob(b.$a("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.v4b=function(){Nvc(this.va,!1);this.dispatchEvent(new H("rc"))};p.GHb=function(a,b,c){this.dispatchEvent(new Ovc(this.F.s5,a.ep||null,b,c,this.F.N_,a.query))};p.u4b=function(){O.Ro.Ac()};var uwc={title:"",N_:0,s5:null},rwc={title:"",N_:5,s5:1},HX={title:"Suggested questions",N_:5,s5:1},twc={title:"Did you mean?",N_:2,s5:4},swc={title:"Related questions",N_:4,s5:4};function IX(a,b,c,d,e,f,h,k,l,m,r,v,w){hX.call(this,w);this.re=c;this.Fd=d;this.Xe=e;this.dc=a;this.hb=new evc(this.Fd);this.Ya=h;this.Ha=m;this.rf=r;this.Ke=v;this.L=this.D=this.Cb=this.F=null;this.Ob="";this.va=new Yvc;this.Jb=f;this.Ca=this.Ub=this.Na=this.H=null;this.Qa=k;this.vd=!1;this.xb=zi(new yi,10).build();this.qd=new Ah;this.pb=l;this.V={};this.Wc=Ui.getInstance();this.jb="";this.$=null}u(IX,hX);p=IX.prototype;p.Sa=function(){IX.ea.Sa.call(this);this.nJ(null==this.H)};
p.Bva=function(a,b){IX.ea.Bva.call(this,a,b);b=this.xa();var c=this.O,d=S(mwc);b.appendChild(a,d);this.D=new fwc(this.Jb,this.va,10,b);c.Ta(this.D);this.D.ob(d);c.getHandler().R(this.D,"answers-submit-query",t(this.p4b,this))};p.K9=function(){IX.ea.K9.call(this);this.D=null};p.nJ=function(a){var b=this;this.D&&this.D.setVisible(!a);a?(this.$&&this.$.dispose(),this.$=new Ck(function(){IX.ea.nJ.call(b,a)},300,this),F(this,this.$),this.$.start()):(this.$&&this.$.stop(),IX.ea.nJ.call(this,a))};p.dg=ca("Cb");
function vwc(a,b,c,d,e,f,h){h=void 0===h?[]:h;a.hb.Ie(c,b,d,e,h);h=vb(Ec(c,1),function(a){return a.getName()});var k=[],l=[];x(Ec(c,2),function(a){k.push(a.getName());l=l.concat(Ec(a,2))});Zvc(a.va,h,k,l);a.dc.Vda().then(function(a){this.va.F=a;this.D&&(a=this.D,Im(a.xa())==a.C&&a.MWa())},null,a);a.H=b;a.Na=d;a.Ub=e;a.Ca=c;a.xb=Ai(zi(new yi,10),wwc(a)).build();if(f&&un)for(c=vb(a.C,function(a){if(a instanceof CX||a instanceof FX)return a.VP().D}),a.R_(),d=0;d<c.length;d++)if(e=c[d])f=new RW,N(f,1,
5),xwc(a,e,f);a.nJ(null==b)}p.reset=function(){lU(this.V);lU(this.va.D);var a=this.va;a.F=[];a.C.clear();this.L=null;this.hHa()};
function xwc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;var f=a.Ha.L.lw();N(c,13,f);f=new SW;ji(f,5,c);kwc(a.D);if(!a.Cb||3<=a.Cb.getStatus().getState().C)if(a.V[b])ywc(a,b,!1);else{d=new AX(b,null,null,null,2,a.Ha);zwc(a,d,!0,f);return}else{var h=a.V[b];h&&h instanceof FX&&2==h.VP().error&&delete a.V[b]}if(b&&a.H)if(a.V[b])a.Jb.hc(2681,a.xb),ywc(a,b,!0);else{h=wwc(a);var k=hi(hi(h,LT,46),SW,4);N(k,2,e);e=Ai(zi(new yi,10),h).build();a.Jb.hc(2635,e);e=gw(a.H.rect);b=Vk(Yj(Wk(ak(bk(a.Cb.yf("/answers/parse").Yf("q",
b,"qt",L(c,1),"gid",a.H.Yc,"range",e,"context",a.Ob),t(a.Uk,a,b,f)),t(a.o4b,a,b,f)),"POST"),2));un&&a.Na&&null!=a.Ub&&(c=0==a.Na.rect.width||0==a.Na.rect.height?"":gw(a.Na.rect),b.Yf("headerRange",c,"tableRecordDimension",""+a.Ub));d&&b.Yf("sgfml",d);b.Re();a.jb=Vi(a.Wc,Fj.fza);lwc(a.D,!0)}else hwc(a.D,"")}function ywc(a,b,c){var d=a.V[b];d!=rb(a.C)&&(1<a.C.length&&Awc(a),c&&Bwc(a,d.VP()).then(function(a){Cwc(this,d,a)},null,a),Itc(a,d))}
p.p4b=function(a){var b=a.C;var c=a.va;var d=a.J,e=a.$;c?c=mvc(b,d,e,c):(c=new RW,N(c,1,b));xwc(this,a.V,c,a.F,a.L)};p.o4b=function(a,b){if(this.H){var c=L(hi(b,RW,5),1);c=1==c||4==c?Ysc.GDa:Ysc.eEa;var d=wwc(this),e=hi(hi(d,LT,46),SW,4);N(e,1,c);N(b,1,c);c=Ai(zi(new yi,10),d).build();this.Jb.hc(2640,c);Dwc(this,a,b)}};function Dwc(a,b,c){lwc(a.D,!1);b=new AX(b,null,null,null,3,a.Ha);zwc(a,b,!1,c);Ewc(a)}
p.Uk=function(a,b,c){this.H&&this.Qa.C.D.Xd.then(function(){var d=null,e=null,f=!1,h=hi(b,RW,5),k=L(h,1),l=wwc(this);k=1==k||4==k?Ysc.GDa:Ysc.eEa;var m=hi(hi(l,LT,46),SW,4);N(m,1,k);N(b,1,k);l=Ai(zi(new yi,10),l).build();if(c.Vl()){e=this.qd.Pc(VW.Pa(),c.Kf());if(f=e.getStatus()){switch(f){case 1:var r=2639;break;case 2:r=2643;break;case 3:r=2644;break;case 4:r=2638;break;case 5:r=2707;break;case 6:r=2706}r&&this.Jb.hc(r,l)}r=B(e,10);N(h,4,r);r=B(e,11);N(h,5,r);zc(e,16)&&(r=B(e,16),N(h,16,r));if(1==
f){Dwc(this,a,b);return}if(2==f){e=-1!=Fwc(a);h=-1!=lvc(a);f=4;d=hi(b,RW,5);e?(f=5,N(d,8,2)):h&&(f=7,N(d,8,1));h=new AX(a,null,null,null,f,this.Ha);e?(e=new FX(h,!0,this.pb,!0,this.xa()),Gwc(this,h,e,b)):zwc(this,h,!0,b);lwc(this.D,!1);Ewc(this);return}r=zc(e,2)?B(e,2):null;f=!0;if(r){k="";d=Zuc(this.Qa,r,this.H,!!this.Ca&&!!B(this.Ca,4));N(h,14,!!d);if(!d){if(m=r.match(/([A-Z]*)\(/)){var v=hi(hi(nja(l),LT,46),SW,4);N(v,7,m[1]);N(b,7,m[1])}this.Jb.hc(2645,l)}d&&$uc(d)||(l=this.Qa,v=this.H,k="="!=
r[0]?"="+r:r,m=Hwc(l),v=Iwc(m,v),k=kAb(l.C,k,m,v.row,v.Kj));l=zc(e,19)?Zuc(this.Qa,B(e,19)||"",this.H,!!this.Ca&&!!B(this.Ca,4)):d;d=new AX(a,d,"="!=r[0]?"="+r:r,e,null,this.Ha,l);zc(e,23)&&d.Ql()?this.Ob=Fc(e,23):this.Ob="";k&&d.L.push(k);d.Ql()&&ji(h,15,d.V)}else zc(e,9)&&(r=e.getError(),d=new AX(a,null,null,e||null,6,this.Ha),l=B(r,2),N(h,6,l),zc(r,3)&&(r=B(r,3),N(h,12,r)))}else this.Jb.hc(2640,l);d||(d=new AX(a,null,null,e||null,4,this.Ha));lwc(this.D,!1);svc(d)?Jwc(this,d,f,b):zwc(this,d,f,b);
Ewc(this)},function(){Dwc(this,a,b)},this)};function Ewc(a){""!=a.jb&&(Wi(a.Wc,a.jb),a.jb="")}function Kwc(a){if(null!=a.ep)return swc;switch(a.error){case 4:case 6:return 0<a.O.length?twc:HX;case 5:return HX}return uwc}function wwc(a){var b=new SW;N(b,8,Hsa);var c=new LT;ji(c,4,b);a=Stc(a.H);ji(a,46,c);return a}function Fwc(a){return Ab(jvc,function(b){return Qa(a,b)})}
function Lwc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.Ca&&!!B(a.Ca,4);e=Zuc(a.Qa,e,a.H,f);$uc(e)&&(e={query:B(b[d],1),ep:B(b[d],2),type:b[d].getType()},zc(b[d],5)&&(e.uKa=B(b[d],5)),c.push(e))}return Hi(c)}function Jwc(a,b,c,d){c=new CX(b,a.re,a.Fd,a.Xe,a.Jb,a.pb,a.Ya,c,0,a.vd,a.xa());Gwc(a,b,c,d)}
function Mwc(a,b,c){if(a.F&&a.F.kb())RI(a.F);else{var d=a.rf.D.C["ritz-ap"]||null;c.Ffa()&&(a.F=TI(a.Ke,a.xa(),d,void 0,"answersChartsPromo"),a.F&&(a.F.show(),F(a,a.F),a.getHandler().Kc(a,"ze",a.hHa)));b.Ql()&&o1a(d,"answersChartsPromo")}}p.Nga=function(){IX.ea.Nga.call(this);this.F&&this.F.kb()&&this.F.C.xd()};p.hHa=function(){this.F&&this.F.kb()&&RI(this.F)};function zwc(a,b,c,d){c=new FX(b,c,a.pb,!1,a.xa());Gwc(a,b,c,d)}
function Gwc(a,b,c,d){Awc(a);var e=Bwc(a,b,d);Nwc(a,c);c instanceof CX&&Mwc(a,b,c);Owc(a);svc(b)&&$vc(a.va,b.D);e.then(function(a){if(d){var b=wwc(this),e=hi(b,LT,46);ji(e,4,d);b=Ai(zi(new yi,10),b).build();this.Jb.hc(2781,b)}Cwc(this,c,a)},null,a);c.coa()&&(a.V[b.D]=c);a.getHandler().R(c,"rc",a.WPa)}function Cwc(a,b,c){b instanceof FX&&null!=c&&eq(c.getElement())&&(b=b.getElement(),Q(b,!1),a.getHandler().R(c,"rc",a.WPa))}
function Awc(a){Pwc(a);x(a.C,function(a){a instanceof FX&&(a=a.getElement(),Q(a,!0))});Qwc(a)}function Qwc(a){0!=a.C.length&&(a.L?Itc(a,a.L):(a.L=new pwc(a.xa()),Nwc(a,a.L)))}function Pwc(a){x(a.C,function(b){b instanceof CX||b instanceof FX||b==a.L||a.aJ(b)})}function Rwc(a,b){var c=Hi([]);b=b.Ca;0<b.length&&(c=hvc(a.hb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?Puc(a.dc,c).then(function(a){return Lb(b,a)}):Hi(b)})}
function Bwc(a,b,c){var d=Kwc(b),e=null;d==swc||d==twc?0<b.O.length&&(e=Lwc(a,b)):d==HX&&(e=Rwc(a,b));var f=null;return e?(f=new GX(new jv,a.pb,e,d,b,a.xa()),Nwc(a,f),a.Jb.hc(2769,a.xb),a.getHandler().R(f,"sqc",t(a.FHb,a)),e.then(function(a){if(c){var b=hi(c,RW,5);Bb([swc,twc],f.F)?(a=ovc(a),ji(b,7,a)):Bb([rwc,HX],f.F)&&(a=pvc(a),ji(b,9,a))}return f},null,a)):Hi(f)}p.FHb=function(a){hwc(this.D,a.F,!0);var b=a.V;b=1==b?mvc(b,a.C,a.J,3):nvc(b,a.C,a.J,a.$);xwc(this,a.F,b,a.L);this.Jb.hc(2762,this.xb)};
function Nwc(a,b){b.Ze(a.Gd());a.C.push(b);if(a.Ye){Htc(a,!1);var c=a.J.jd();b.O=c;a.J.Nh(b,0,!0);b.JL()}Atc(b,!0)}function Owc(a){for(var b=a.C;5<b.length;)a.aJ(b[0])}p.R_=function(){IX.ea.R_.call(this);this.reset()};
p.WPa=function(a){var b=this,c=this.xa();a=a.target;if(a instanceof CX)this.aJ(a),DX(this.Ya,"Answer removed",c,t(this.yEb,this,a));else if(a instanceof FX)this.aJ(a),DX(this.Ya,"Card removed",c);else if(a instanceof GX&&a.C&&!svc(a.C)){var d=a.C.D;x(this.C,function(a){a instanceof FX&&a.VP().D==d&&(b.aJ(a),DX(b.Ya,"Card removed",c))})}a=this.C;!this.L||a[0]!=this.L&&a[a.length-1]!=this.L||(this.aJ(this.L),this.L=null)};
p.yEb=function(a){Jwc(this,a.VP(),a.coa());DX(this.Ya,"Remove answer undone",this.xa())};p.aJ=function(a){if(a.gc()){if(a instanceof CX||a instanceof FX)delete this.V[a.VP().D],a==rb(this.C)&&Pwc(this);IX.ea.aJ.call(this,a)}G(a)};function Swc(){var a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(Zt({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Sr("Ask a question about your data")+'"/></div></form></div>');return V(a)};function Twc(a,b){this.C=a;this.D=b}function Zuc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=Hwc(a);c=Iwc(e,c);(a=Gsc(a.C,b,e,c.row,c.Kj))&&d&&a.length<a[0].length&&(a=wuc(a));return a}function $uc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function Hwc(a){a=nv(a.D);return null!=a?a.toString():"0"}
function Iwc(a,b){var c={row:0,Kj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Nc()+1?c.row=b.Nc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Sc()+1&&(c.Kj=b.Sc()+1));return c};function JX(a,b,c,d,e,f,h,k,l,m){iX.call(this,1,f,e,m);this.xb=c;this.Ha=null;this.va=new Hs("",new bX,this.xa());this.Ta(this.va);this.Na=new Hs("",new bX,this.xa());this.Ta(this.Na);a=new nAb(a,!0,!0);a=new Twc(a,c);this.jb=new Mvc(e);this.O=new Vuc(this.xb,a,e);this.L=new IX(this.O,0,b,c,d,e,this.hb,a,this.jb,h,k,l,m);c=Uwc;this.D=new avc(b,c.D3a,c.E3a);F(this,this.D);this.F=this.H=null;this.pb=zi(new yi,10).build();this.Ca=!1}u(JX,iX);
var Uwc={D3a:"waffle-assistant-answers-styled-border",E3a:"waffle-assistant-answers-styled-rect",P3a:"waffle-assistant-answers-input-box",k5a:"waffle-assistant-answers-query-box",uxc:"waffle-assistant-answers-query-box-focused",e4a:"waffle-assistant-answers-learn-more",ksc:"waffle-assistant-answers-logging-message-container",P4a:"waffle-assistant-answers-logging-opt-out"};p=JX.prototype;p.Da=function(){JX.ea.Da.call(this);var a=S(Swc);this.xa().appendChild(Jtc(this),a)};
p.Sa=function(){JX.ea.Sa.call(this);var a=Uwc,b=this.$a(a.k5a),c=this.$a(a.P3a);this.Na.ob(this.$a(a.P4a));this.va.ob(this.$a(a.e4a));this.getHandler().R(b,"focus",this.JDb,!0).R(b,"blur",this.HDb,!0).R(b,"mouseover",this.LDb).R(b,"mouseout",this.KDb).R(b,"click",this.IDb).R(c,"input",this.q4b).R(this.Na,"action",this.aCb).R(this.va,"action",this.Gyb).R(zv(this.xb),"Ea",slc(this.r4b,25,this));this.setVisible(null!=this.H);Vwc(this,nsa&&qsa&&vn("showAnswersLoggingOptOut"))};p.uYa=Vf;p.LQa=Wf;
p.Gwa=Vf;p.wX=n("Answers");p.Mga=n(1);p.X8=function(a){return 3==a||0==a};p.d6=function(a,b){Ub(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Fc(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}if(d&&B(d,2)){e=b||null;f=zc(d,11)?B(d,11):null;var h=null==f?null:BT(B(d,10));0<Ac(d,4)?Wwc(this,BT(GT(d)),B(d,9),h,f,c):Wwc(this,e,B(d,9),h,f,c);this.F||(JX.ea.d6.call(this,a,b),this.getHandler().R(this.F,"sqc",this.EHb))}else this.vX(!0)};
p.b0=function(a){if(!this.F){var b=Puc(this.O,3);this.F=new GX(a,this.jb,b,rwc,void 0,this.xa())}return this.F};p.CGa=g("L");p.Pra=function(){return this.kb()};
p.vX=function(a,b,c){this.O.reset();(a||b)&&this.F&&(JX.ea.vX.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||q(b)&&!b)this.F&&(JX.ea.vX.call(this,a,b,c),this.F.dispose(),this.F=null),this.gc()&&(this.O.reset(),this.H=null,a=this.L,a.gc()&&(b=a.va,b.F=[],b.C.clear(),a.D&&(b=a.D,b.gc()&&(b.C&&Xvc(b.C),b.F.isDisposed()||b.F.setVisible(!1),b.L=!1)),a.R_(),a.hb.reset(),a.H=null,a.nJ(!0)),this.setVisible(!1),this.$b()&&xX(this.D));c&&this.L.reset()};p.dg=function(a){this.Ha=a;this.L.dg(a);this.O.dg(a)};
p.setActive=function(a){JX.ea.setActive.call(this,a);a?wX(this.D,this.H):xX(this.D)};function Xwc(a,b){a.$b()&&(b?xX(a.D):wX(a.D,a.H))}function Vwc(a,b){Q(a.$a("waffle-assistant-answers-logging-message-container"),b)}function Ywc(a,b){a=a.$a("waffle-assistant-answers-query-box");Gp(a,"waffle-assistant-answers-query-box-focused",b)}p.r4b=function(){this.$b()&&wX(this.D,this.H)};p.JDb=function(){Ywc(this,!0);wX(this.D,this.H)};p.HDb=function(){Ywc(this,!1);this.$b()||xX(this.D)};
p.LDb=function(){wX(this.D,this.H)};p.KDb=function(){this.$b()||xX(this.D)};p.IDb=function(){Zwc(this,"")};p.q4b=function(){var a=this.$a("waffle-assistant-answers-input-box");Zwc(this,a.value);a.value=""};p.EHb=function(a){var b=this,c=a.F;Zwc(this,c);var d=mvc(1,a.C,a.J,1),e=new Ck(function(){xwc(b.L,c,d,a.L)},300);F(this,e);e.start();this.bt().hc(2652,this.pb)};
function Zwc(a,b,c){a.setActive(!0);a.dispatchEvent("Ee");var d=new Ck(function(){hwc(a.L.D,b,!0);var d=a.L,f=c||!1;d.vd=f;d.dc.$=f;d.hb.$=f},300);F(a,d);d.start()}function Wwc(a,b,c,d,e,f){c=c||new gv;a.H=b;a.O.Ie(c,b,d,e,f);a.O.Uda();a.setVisible(null!=b);vwc(a.L,b,c,d,e,a.Ca,f);a.Ca=!1;a.$b()&&wX(a.D,a.H)}p.aCb=function(a){a.stopPropagation();a.preventDefault();this.Ha&&(Wk(ak(bk(this.Ha.yf("/answers/logoptout"),t(this.szb,this)),t(this.rzb,this)),"POST").Re(),this.bt().hc(2663,this.pb))};
p.Gyb=function(a){a.stopPropagation();a.preventDefault();jp("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.szb=function(a){a.Vl()&&Vwc(this,!1)};p.rzb=ba();function $wc(){var a=V;var b=""+U(Os({Ae:"waffle-assistant-datavalidation-apply-button",content:Or("Apply"),style:4}));b=V(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function axc(a){return V('<div class="waffle-assistant-datavalidation-detail-chip">'+U(a.uab)+"</div>")};function bxc(a,b){fX.call(this,a,b);this.C=new Ps("",this.xa());this.Ta(this.C)}ha(bxc,fX);p=bxc.prototype;p.Da=function(){fX.prototype.Da.call(this);gX(this).appendChild(S($wc))};p.Sa=function(){fX.prototype.Sa.call(this);var a=this.$a("waffle-assistant-datavalidation-apply-button");this.C.ob(a);dX(a,"Apply data validation");this.getHandler().R(this.C,"action",this.apb)};
p.jF=function(a){var b=gw(Gh(GT(this.D))),c=B(B(this.D,13),3);switch(B(c,1)){case 14:var d="Email validation";c=["xyz@gmail.com"];break;case 15:d="URL validation";c=["www.google.com"];break;case 30:d="Date validation";c=["1970/01/01"];break;case 24:d="List of items";c=Ec(c,2).map(function(a){return B(B(a,5).Xa(),2)});break;default:Hsc.C("Unrecognized data validation type."),d="unrecognized",c=[]}var e=new Wu;b=e.text(d)+(" for "+(e.$e("SPAN".toString(),{nG:"waffle-assistant-datavalidation-range"})+
e.text(b)+e.gf("SPAN".toString())));Ml(this.$a("waffle-assistant-datavalidation-description"),e.format(b));var f=this.$a("waffle-assistant-datavalidation-details");x(c,function(a){a=S(axc,{uab:a});f.appendChild(a)});a()};p.dF=ba();p.XC=n("assistantDataValidationFeedback");p.uH=n(35551);p.tH=n(35550);p.apb=function(){this.dispatchEvent(new aX("ye",this,35549))};function cxc(a,b,c){iX.call(this,3,b,a,c)}ha(cxc,iX);p=cxc.prototype;p.wX=n("Data Validation");p.X8=function(a){return 6==a};p.b0=function(a){var b=B(a,1);switch(b){case 6:return new bxc(a,this.xa());default:throw Error("Unsupported recommendation type: "+b);}};p.Ze=function(a){iX.prototype.Ze.call(this,a);this.setVisible(!a)};p.e6=function(a){return this.Gd()?(this.setVisible(!1),a):iX.prototype.e6.call(this,a)};p.Mga=n(3);function dxc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+exc()+"</div>");return V(a)}
function fxc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+exc()+"</div>")}function exc(){var a=""+U(Os({Ae:"waffle-assistant-formatting-edit-button",content:Or("Edit"),style:4}));return V(a)};function gxc(a,b,c){fX.call(this,a,c);a=vb(Ec(this.D,7),Llc);this.C=new NU(!1,a,7);this.Ta(this.C);this.J=new Ps("",this.xa());this.Ta(this.J);this.Jb=b;this.H=!1;this.F=-1}u(gxc,fX);var hxc={zha:"waffle-assistant-banding-color-picker-container",Lha:"waffle-assistant-formatting-edit-button",xK:"waffle-assistant-banding-range"};p=gxc.prototype;p.Da=function(){gxc.ea.Da.call(this);gX(this).appendChild(S(dxc))};
p.Sa=function(){gxc.ea.Sa.call(this);this.getHandler().R(this.J,"action",this.Iub).R(this.C,"banding-scheme-changed",this.Epb);this.Jb.C(2768)};p.jF=function(a){var b=this.$a(hxc.zha);this.C.render(b);Rlc(this.C);b=this.$a(hxc.xK);var c=GT(this.D),d=Gh(c);tm(b,gw(d));ixc(this,c);b=this.$a(hxc.Lha);this.J.ob(b);a()};p.dF=function(){yp(this.La,"Suggested alternating background colors");hr(this.C,"Choose a color scheme")};p.XC=n("assistantBandingFeedback");p.uH=n(2672);p.tH=n(2671);
p.Iub=function(a){Tn.dispatchEvent({type:"show-banding-pane-recommendation",rWa:this.D,Z$a:Slc(this.C)});a.stopPropagation()};p.Epb=function(a){if(!this.H&&OU(this.C)){var b=this.F;this.F=this.C.Ph();this.F==b?this.dispatchEvent(new aX("De",this,2797)):this.dispatchEvent(new aX("we",this,2673));a.stopPropagation()}};
function ixc(a,b){a.H=!0;var c=b.Lb();b=Gh(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.tc(),b.qc(),b.Nc(),b.Sc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new Ah).Pc(Ad.Pa(),c),c=Llc(c)):c=null;c?(c=Tlc(a.C,c),eJ(a.C,c?c.getElement():null)):eJ(a.C,null);a.F=a.C.Ph();a.H=!1};function jxc(a,b){fX.call(this,a,b);this.C=new Ps("",this.xa());this.Ta(this.C);this.xb=Ec(a,6)}u(jxc,fX);var KX={Lha:"waffle-assistant-formatting-edit-button",o3a:"waffle-assistant-conditionalformat-format-preview",H5a:"waffle-assistant-conditionalformat-rule-holder",E6:"waffle-assistant-conditionalformat-description",M4a:"one-rule",O6a:"two-rules",B6a:"three-rules",d5a:"waffle-assistant-conditionalformat-format-preview-label"};p=jxc.prototype;p.Da=function(){jxc.ea.Da.call(this);gX(this).appendChild(S(fxc))};
p.Sa=function(){jxc.ea.Sa.call(this);var a=this.$a(KX.Lha);this.C.ob(a);dX(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.Zob)};p.jF=function(a){tm(this.$a(KX.E6),Fc(this.D,3));var b=this.$a(KX.H5a),c=new kxc(this,this.xa());this.Ta(c);c.ob(b);dX(b,"Apply conditional format rules");a()};p.dF=xa;p.XC=n("assistantConditionalFormatFeedback");p.uH=n(2630);p.tH=n(2629);
p.Zob=function(){this.dispatchEvent(new aX("xe",this,2563));this.dispatchEvent(new aX("Ae",this,2670,void 0,void 0,Gh(B(this.xb[0],1,0))));Xn()};function kxc(a,b){er.call(this,void 0,void 0,b);this.C=a}u(kxc,er);
kxc.prototype.zd=function(a){kxc.ea.zd.call(this,a);var b=this.C.xb;switch(b.length){case 0:break;case 1:var c=KX.M4a;break;case 2:case 4:c=KX.O6a;break;default:c=KX.B6a}for(var d=0;d<b.length;d++){var e=b[d],f=bm("DIV");Dp(f,[KX.o3a,c]);var h=bm("DIV");Bp(h,KX.d5a);f.appendChild(h);tm(h,"123");if(zc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:k=Ec(B(k,1),2)[0];var l=Ec(e,1)[0];tm(h,sz(k,Fc(l,1),Fc(l,2),Fc(l,4)))}}Vkc(e,f);a.appendChild(f)}};
kxc.prototype.Ci=function(){var a=this.C;a.dispatchEvent(new aX("xe",a,2563));return!0};function lxc(a,b,c){iX.call(this,2,b,a,c)}u(lxc,iX);p=lxc.prototype;p.wX=n("Formatting");p.X8=function(a){return 2==a||4==a};p.b0=function(a){var b=B(a,1);switch(b){case 2:return new jxc(a,this.xa());case 4:return a=new gxc(a,this.bt(),this.xa()),this.getHandler().R(a,"we",this.WXb).R(a,"De",this.uKb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.WXb=function(a){DX(this.hb,"Alternating colors applied",this.xa(),t(this.Fpb,this,a.C))};p.uKb=function(){this.hb.clear()};
p.Fpb=function(a){this.dispatchEvent(new aX("Ie",a,2796))};p.Ze=function(a){lxc.ea.Ze.call(this,a);this.setVisible(!a)};p.e6=function(a){return this.Gd()?(this.setVisible(!1),a):lxc.ea.e6.call(this,a)};p.Mga=n(3);function LX(a,b,c,d,e){R.call(this);this.O=a;this.Ya=b;this.va=c;this.H=d;this.D=e}ha(LX,R);LX.prototype.getTableRange=g("va");LX.prototype.zfa=function(a,b,c){this.va=a;this.H=b;this.D=c};LX.prototype.Sa=function(){R.prototype.Sa.call(this);this.getHandler().R(this.O.C,"M",this.cb)};LX.prototype.cb=function(){this.Ya.Ac()};function mxc(a,b){D.call(this);this.F=a;this.H=b;this.C=new avc(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");F(this,this.C);this.D=new avc(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");F(this,this.D)}ha(mxc,D);mxc.prototype.Ka=function(){xX(this.C);xX(this.D);D.prototype.Ka.call(this)};
function nxc(a,b,c,d,e,f){uzb(b);var h=Gh(d);h=new gh(h.tc(),h.qc(),Math.min(h.Nc(),h.tc()+6),Math.min(h.Sc(),h.qc()+6));var k=v5a(b),l=lB(a.F).pe(),m=l.Jg(new Wg(h.tc(),h.Nc()),"r",!0,!1,!0,!0)-1,r=l.Jg(new Wg(h.qc(),h.Sc()),"c",!0,!1,!0,!0)-1;l.mc()&&--r;m=Math.min(200,m);r=Math.min(c.offsetWidth-2,r);vzb(b,k,r,m);c=Qtc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.tc();k=d.qc();switch(e){case 0:h=Math.min(d.Nc(),d.tc()+f);break;case 1:k=Math.min(d.Sc(),d.qc()+f)}d=Bh(d.Lb(),h,k,d.Nc(),d.Sc());wX(b,BT(d));
wX(a.D,BT(c))};function oxc(a){var b=a.JVa,c=a.IVa,d=a.gUa;a=a.AFa;return V('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+W(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+U(b)+'</div></div><div class="waffle-tables-popup-content">'+U(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
U(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+U(a)+"</div></div></div></div>")}
function pxc(){var a=""+oxc({JVa:Or("Edit data range"),IVa:Pr(""+V('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>')),gUa:Or("Update"),
AFa:Or("Cancel")});return V(a)}function qxc(){var a=""+oxc({JVa:Or("Improve suggestions"),IVa:Pr('<div class="waffle-tables-popup-header-message"></div>'),gUa:Or("No"),AFa:Or("Yes")});return V(a)}function rxc(a){a='For <span class="waffle-assistant-table-bar-range">'+(U(a.sJ)+"</span>");return V(""+a)}function sxc(a){a='Is <span class="waffle-assistant-table-first-header">'+(U(a.jO)+"</span> a header row, containing titles that describe the columns below?");return V(""+a)};function MX(a,b,c,d,e,f,h){LX.call(this,a,X.OZ,d,e,f);this.C=(new iM).build();F(this,this.C);this.J=new Hs("",new cX,this.xa());this.Ta(this.J);lu(this.C,this.J,X.i8);this.F=new Hs("",new cX,this.xa());this.Ta(this.F);lu(this.C,this.F,X.OZ);this.V=new mxc(b,c);F(this,this.V);this.L=new fp(this);F(this,this.L);this.Ca=h}ha(MX,LX);MX.prototype.Da=function(){this.La=S(qxc)};
MX.prototype.Sa=function(){LX.prototype.Sa.call(this);this.J.ob(this.$a("waffle-tables-popup-done"));this.F.ob(this.$a("waffle-tables-popup-cancel"));var a=Qtc(this.getTableRange(),this.D,1);a=gw(Gh(a));a=S(sxc,{jO:a});this.$a("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(X.i8,"action",this.Ha).subscribe(X.OZ,"action",this.$);a=this.$a("waffle-assistant-table-canvas");var b=this.$a("waffle-assistant-canvas-container");nxc(this.V,a,b,this.getTableRange(),this.D,this.H);a=this.$a("waffle-tables-popup");
Gp(a,"waffle-tables-popup-answers-enabled",this.Ca);b=new lH(a,this.xa());F(this,b);mH(b);a.focus()};MX.prototype.$=function(){this.dispatchEvent("Ge")};MX.prototype.Ha=function(){var a=Gh(this.getTableRange());switch(this.D){case 0:a=bha(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=bha(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=gw(a);this.dispatchEvent(new qtc(a,this.H-1,this.D));this.dispatchEvent("Ge")};function txc(a,b,c,d,e,f,h,k,l){LX.call(this,a,X.DR,d,e,f);var m=this;this.hb=b;this.Qa=d;this.xb=e;this.Cb=f;a=Gh(d);this.F=gw(a);this.Na=new mxc(b,c);F(this,this.Na);this.C=null;this.Jb=h;this.J=(new iM).build();F(this,this.J);this.$=new Hs("",new cX,this.xa());this.Ta(this.$);lu(this.J,this.$,X.LZ);this.V=new Hs("",new cX,this.xa());this.Ta(this.V);lu(this.J,this.V,X.DR);this.L=new DU(this.hb,function(a,b,c){uxc(m,a,b,c)},!1,"e.g., A2:D5",!0,this.O.C.C.C,this.xa());this.Ta(this.L);this.Ca=null;
this.Ha=new fp(this);F(this,this.Ha);this.jb=k;this.pb=l}ha(txc,LX);p=txc.prototype;p.Da=function(){this.La=S(pxc)};
p.Sa=function(){LX.prototype.Sa.call(this);this.$.ob(this.$a("waffle-tables-popup-done"));this.V.ob(this.$a("waffle-tables-popup-cancel"));this.L.render(this.$a("waffle-assistant-tables-data-range-wrapper"));var a=this.$a("waffle-range-selection-input");vp(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().R(a,"keydown",this.NNb).R(a,"keyup",this.ONb).R(a,Xba,this.$Hb).R(this.L,"change",this.PNb);this.Ha.subscribe(X.LZ,"action",this.QNb).subscribe(X.DR,"action",this.aqb);
vxc(this);a=this.$a("waffle-tables-popup");Gp(a,"waffle-tables-popup-answers-enabled",this.pb);var b=new lH(a,this.xa());F(this,b);mH(b);a.focus()};p.Ka=function(){G(this.Ca);LX.prototype.Ka.call(this)};function uxc(a,b,c,d){FT(a.jb,null,b,c,d,!1,void 0,function(b){a.Ca=b})}function wxc(a){var b=a.$a("waffle-assistant-table-canvas"),c=a.$a("waffle-assistant-canvas-container");nxc(a.Na,b,c,a.getTableRange(),a.D,a.H)}p.aqb=function(){this.dispatchEvent("Ge")};
p.QNb=function(){var a=!Yv.test(this.F);Q(this.Fb("waffle-assistant-tables-range-error"),a);Gp(this.$a("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.xb!=this.H||this.Cb!=this.D;var b=!qlc(this.Qa,this.getTableRange());if(a||b)a&&this.Jb.hc(35506),b&&this.Jb.hc(35507),this.dispatchEvent(new qtc(this.F,this.H,this.D));this.dispatchEvent("Ge")}};
function vxc(a){var b=a.$a("waffle-range-selection-input"),c=Gh(a.Qa);a.F=gw(c);b.value=a.F;xxc(a);wxc(a)}p.zfa=function(a,b,c){LX.prototype.zfa.call(this,a,b,c);wxc(this)};function yxc(a){var b=ov(a.O.C),c=b.yc();b=MJa(a.F,b);null!=b&&(c=Eh(b,c),a.zfa(c,zxc(a,c),a.D),xxc(a))}function zxc(a,b){b=Axc(b,a.D);return a.H>b?b:a.H}function Axc(a,b){a=0==b?a.Nc()-Fc(a,2):a.Sc()-Fc(a,4);return Math.min(a-1,3)}
function xxc(a){G(a.C);a.C=new HH;a.Ta(a.C);lu(a.J,a.C,X.lja);JT(a.C,QU.getInstance());a.C.render(a.$a("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.Uwb);for(var b=Axc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new go("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Nd(new qr(d))}c=Axc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new go("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Nd(new qr(e))}c=a.H;a.C.Xf(0==a.D?c:c+b+1);vp(a.C.La,"label","Headers")}p.$Hb=function(){var a=this.$a("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,yxc(this))};p.PNb=function(){var a=this.L.Xa();this.F=a;var b=this.$a("waffle-range-selection-input");b.value=a;b.select();yxc(this)};
p.NNb=function(a){var b=this.$a("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;yxc(this);X.LZ.Ac();break;case 27:a.stopPropagation(),a.preventDefault(),vxc(this),X.DR.Ac()}};p.ONb=function(){this.F=this.$a("waffle-range-selection-input").value;yxc(this)};p.Uwb=function(){var a=this.C.Ph(),b=Axc(this.getTableRange(),0);this.zfa(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function NX(a,b,c,d){du.call(this,a,b,c,d,void 0,void 0,!0)}u(NX,du);NX.prototype.Da=function(){NX.ea.Da.call(this);Bp(this.La,"waffle-assistant-toast");Bp(this.$a("docs-ui-toast-content"),"waffle-assistant-toast-content")};NX.prototype.gC=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=uq(this,b);NX.ea.gC.call(this,a,b,c)};NX.prototype.Th=function(a,b,c,d){this.gC(a,b,d);a=wq(this,b);this.getHandler().Yh(a,hd,t(function(){this.setVisible(!1);c()},this))};function Bxc(){this.C=null}u(Bxc,D);Bxc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function DX(a,b,c,d){a.clear();a.C=new NX(b,c,!1,5E3);a.C.render();d&&a.C.Th("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}Bxc.prototype.Ka=function(){Bxc.ea.Ka.call(this);this.clear()};function Cxc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Sr("Press enter to insert formula")+'"></span></div>');return V(a)};function OX(a,b){R.call(this);this.C=a;this.D=b}u(OX,R);p=OX.prototype;p.Da=function(){this.La=S(Cxc,{name:this.C,title:this.D})};p.Sa=function(){OX.ea.Sa.call(this);var a=this.$a("waffle-assistant-quicksum-entry-name");dX(a);this.getHandler().R(this.La,"keypress",this.Z3b);Q(this.La,!1)};p.getFunctionName=g("C");p.gb=function(a){tm(this.$a("waffle-assistant-quicksum-entry-value"),a||"");Q(this.La,!!a)};p.kb=function(){return eq(this.La)};
p.Z3b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new H("insert",this)))};function PX(a,b,c,d,e){R.call(this,e);this.Na=a;this.Ca=b;this.L=c;this.Jb=d;this.D=a.C;this.Ha=new Ah;this.V=zi(new yi,17).build();this.O=zi(new yi,2).build();this.J=!1;this.F=[];this.C=null;this.H=[]}u(PX,R);
PX.prototype.Sa=function(){PX.ea.Sa.call(this);this.Nh(new OX(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Nh(new OX(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Nh(new OX(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Nh(new OX(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Nh(new OX(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new BX(this.La,
this.Ca,this.D,this.L);this.C.Ze(this.J);F(this,this.C);this.getHandler().R(this,"insert",this.$).R(this.C,"formula_inserted",this.va)};
function Dxc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(Nv(a.D)){var c=ov(a.D),d=c.qk(),e=yD(a.D);if(yb(d,c.$t,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=Bh(e+"",h.tc(),h.qc(),h.Nc(),h.Sc());c.push(a.Ha.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){Q(a.La,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.ld(0).gb(b(d.sum));a.ld(1).gb(b(d.average));a.ld(2).gb(b(d.min));a.ld(3).gb(b(d.max));
1<e?a.ld(4).gb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):Q(a.La,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.jd();++d)e=a.ld(d),a.H.push(Exc(a,e.getFunctionName()));a.C.J=a.H}}else Q(a.La,!1)}else Q(a.La,!1)}else Q(a.La,!1)}PX.prototype.Ze=function(a){this.J=a;this.C&&this.C.Ze(a);Gp(this.La,"waffle-assistant-quicksum-panel-readonly",a)};
PX.prototype.$=function(a){var b=a.target;a=this.F[0];a=new Sg(a.left,a.Nc());b=b.getFunctionName();b=Exc(this,b);a=new CG(ov(this.D),a,b);this.L.C(a);this.Jb.hc(2624,this.O)};PX.prototype.va=function(){this.Jb.hc(2624,this.V)};function Exc(a,b){var c=bKa(a.Na.L);a=vb(a.F,function(a){return gw(a)});return"="+b+"("+a.join(c)+")"};function Fxc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(Os({content:Or("INSERT CHART"),style:4,Ae:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(Os({Ae:"waffle-autovis-lightbox-close",content:Pr(""+U(Zt({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Or("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
U(Os({content:Pr("&#10094;"),style:4,Ae:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Qr('aria-label="'+Sr("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(Os({content:Pr("&#10095;"),style:4,Ae:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Qr('aria-label="'+Sr("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.cPb)+"</div></div></div>");return V(a)}function Gxc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function QX(a,b,c,d){R.call(this,d);this.F=a;this.D=b;this.Jb=c;this.H=[];this.C=new Ps("",this.xa());this.Ta(this.C);this.O=new Ps("",this.xa());this.Ta(this.O);this.L=new Ps("",this.xa());this.Ta(this.L);this.J=new Ps("",this.xa());this.Ta(this.J)}u(QX,R);p=QX.prototype;p.Da=function(){QX.ea.Da.call(this);this.La=S(Fxc,{cPb:this.F.length})};
p.Sa=function(){QX.ea.Sa.call(this);var a=X.bQ.isEnabled();this.Ze(!a);a=this.$a("waffle-autovis-lightbox-close");this.C.ob(a);a=this.$a("waffle-autovis-lightbox-insert");this.O.ob(a);var b=this.$a("waffle-autovis-lightbox-previous");this.L.ob(b);b=this.$a("waffle-autovis-lightbox-next");this.J.ob(b);Hxc(this);Ixc(this,this.D,!1);this.getHandler().R(document.body,Wba,this.X_b).R(this.La,"keydown",this.Y_b).R(am(),"resize",this.a0b).R(this.C,"action",this.close).R(this.O,"action",this.Yxb).R(this.L,
"action",this.$_b).R(this.J,"action",this.Z_b);b=new lH(this.La,this.xa());mH(b);F(this,b);a.focus()};function Hxc(a){var b=a.$a("waffle-autovis-lightbox-content"),c=a.$a("waffle-autovis-lightbox-content-inner");a=a.$a("waffle-autovis-lightbox-page-count");var d=Zl();a=bq(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Zp(c,d,e);Zp(b,d,e+a.height+35)}p.Ze=function(a){Gp(this.La,"waffle-autovis-lightbox-readonly",a)};
function Ixc(a,b,c){c&&Vn("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?Jxc(a,b):a.F[b]&&euc(a.F[b],t(a.Tqb,a,b),!0)}p.Tqb=function(a,b){if(!this.isDisposed()&&b){var c=this.$a("waffle-autovis-lightbox-container"),d=S(Gxc);c.appendChild(d);this.H[a]=d;GV(b,d,this.Jb,qn);Jxc(this,a)}};function Jxc(a,b){Q(a.H[a.D],!1);Q(a.H[b],!0);a.L.eb(0!=b);a.J.eb(b!=a.F.length-1);var c=a.$a("waffle-autovis-lightbox-page-number");tm(c,b+1);a.D=b}p.X_b=function(a){!rm(this.La,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.Y_b=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Ixc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Kxc(this);a.stopPropagation()};p.a0b=function(){var a=this.$a("waffle-autovis-lightbox-container");gm(a);this.H=[];Hxc(this);Ixc(this,this.D,!0)};p.Yxb=function(){this.close();huc(this.F[this.D],2256)};p.$_b=function(){0!=this.D&&Ixc(this,this.D-1,!0);0==this.D&&this.J.La.focus()};p.Z_b=function(){Kxc(this);this.D==this.F.length-1&&this.L.La.focus()};
function Kxc(a){a.D!=a.F.length-1&&Ixc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.ud=function(){QX.ea.ud.call(this);var a=this.F[this.D];a&&a.La&&a.La.focus()};function Lxc(a,b,c){I.call(this);this.C=xIa(wIa.getInstance(),a,b,c);this.D=uk()}u(Lxc,I);Lxc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!zb(c,function(a){return pha(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Ih()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&yIa(this.C),this.D=Mxc(),this.D.addCallback(function(){return AIa(d.C,b)}))};Lxc.prototype.dg=function(a){this.C.dg(a)};
function Mxc(){var a=null,b=new nk(function(){null===a||Qi(a)});a=Pi(function(){b.Zb()});return b};function RX(a,b,c,d,e,f){FU.call(this,f);this.Ld=a;this.re=b.C;this.Kb=c;this.jg=d;this.Jb=e;this.cb=new PX(b,c,d,e,this.xa());this.Ta(this.cb);this.O=new OV(!1,"#4285f4");this.Ta(this.O);this.J=null;this.Ic=this.wc=!1;this.Ub=!0;this.Ob=Ui.getInstance();this.pb=this.hb="";this.Na=zi(new yi,10).build()}u(RX,FU);p=RX.prototype;p.Da=function(){RX.ea.Da.call(this);this.La=S(Nxc,{yP:nn})};
p.Sa=function(){RX.ea.Sa.call(this);var a=this.$a("waffle-assistant-quicksum-panel");this.cb.ob(a);a=this.$a("waffle-assistant-spinner-container");this.O.render(a);a=this.Ld.C;this.getHandler().R(this,"close-sidebar",this.Dra).R(a,"recommender-load-started",this.ora).R(a,"recommender-load-ended",this.nra).R(a,"recommender-calc-started",this.Fqa).R(a,"recommender-calc-ended",this.Eqa).R(this.$a("waffle-assistant-scroll-pane"),"scroll",slc(this.Oga,10,this));a=X.bQ.isEnabled();this.Ze(!a)};
p.resize=function(){var a=this.$a("waffle-assistant-sidepane-content");a=bq(a).height;var b=this.$a("waffle-assistant-spinner-container");Kp(b,"margin-top",a/2-16+"px");this.Oga()};p.dg=xa;function Oxc(a,b){var c=Pxc(a);0!=c.length&&(G(a.J),c=c.filter(function(a){return a instanceof jX}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.J=new QX(c,b,a.Jb,a.xa()),a.J.render(),F(a,a.J),a.J.Ze(a.Ic)))}
p.Ze=function(a){this.Ic=a;Gp(this.La,"waffle-assistant-readonly",a);this.cb.Ze(a);this.J&&!this.J.isDisposed()&&this.J.Ze(a)};p.setVisible=function(a){var b=this.kb();RX.ea.setVisible.call(this,a);if(a&&!b){var c=DIa(this.Ld.C,a);c?(b=new Qsc,N(b,1,uh(c,"r")),N(b,2,uh(c,"c")),c=c.Ih(),N(b,3,c),c=new vi,ji(c,4,b),b=Bi(Ci(this.Na),c).build()):b=this.Na;this.pb=Vi(this.Ob,Fj.BAa,!1,b);this.O.setActive(!0);SX(this)}a||Qxc(this,!0)};p.ora=function(){this.kb()&&(Qxc(this,!0),this.O.setActive(!0),SX(this))};
p.nra=function(){this.kb()&&(this.O.setActive(!1),SX(this))};p.Fqa=function(a){this.kb()&&(this.Jb.C(2775,this.Na),Qxc(this,void 0,a.F,a.J),Rxc(this)||this.O.setActive(!0),SX(this),this.Ub=!1)};
p.Eqa=function(a){if(this.kb()){this.Jb.C(2776,this.Na);var b=a.L;0<b.length&&(this.hb=Vi(this.Ob,Fj.zAa));Qxc(this,!1);this.O.setActive(!1);a=a.V;for(var c=ma(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ma(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Fc(h,1);d.X8(k)&&e.push(h)}0<e.length?d.d6(e,a):d.vX(!0)}if(un)for(b=ma(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==Fc(a,1)){this.h9();this.Ca=B(a,12);this.$=GT(a);this.Ha=B(a,11);Sxc(this);a=this.$;c=!1;for(d=this.Qa.length-
1;0<=d;d--)e=this.Qa[d],f=a,e.Kh()&&e.Lb()==f.Lb()&&Osc(Ch(e),Ch(f))&&Osc(Dh(e),Dh(f))&&(c=!0,this.Qa.splice(d,1));this.Qa.push(a);a=c;2!=this.Ca||a||Txc(this,!0)}b=Pxc(this);0<b.length&&this.wc&&(b[b.length-1].Cb=!0);this.wc=!1;SX(this);Uxc(this);this.Oga()}};function SX(a){var b=Rxc(a),c=eq(a.$a("waffle-assistant-quicksum-panel")),d=a.O.$b();b=b||c||d;a=a.$a("waffle-assistant-empty-list");Q(a,!b)}p.Gc=xa;p.Hva=xa;p.bt=g("Jb");p.Gd=g("Ic");p.Dra=xa;
p.qNb=function(){""!=this.hb&&(Wi(this.Ob,this.hb),this.hb="");""!=this.pb&&(Wi(this.Ob,this.pb),this.pb="");this.Ub||(this.Jb.hc(2777,this.Na),this.Ub=!0)};function Nxc(a){a=a||{};var b=V,c=Pr('<div class="waffle-assistant-replaceable-title">'+Vxc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(Dtc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.yP?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=V(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=V(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(U(PU(Nr({title:c,Il:Pr(""+d),id:Or("autovis"),zP:Or("waffle-assistant-sidepanel"),aga:Or("waffle-assistant-title"),$_:Or("waffle-assistant-sidepane-content")},a))))}
function Vxc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(Dtc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function TX(a,b,c,d,e,f,h,k,l,m){RX.call(this,a,b,c,d,e,m);this.rf=f;this.Cb=b;this.Ya=new R(this.xa());this.Ta(this.Ya);this.va=new Bxc;F(this,this.va);this.D=[];this.F=null;this.xb=new Ps("",m,4);mr(this.xb,2,!1);this.Ta(this.xb);this.Fd=h;this.Wf=k;this.vd=l;this.$=null;this.Ca=0;this.Ha=null;this.Xb=new Hs("",new cX,this.xa());this.Ta(this.Xb);this.dc=new R(this.xa());this.Ta(this.dc);this.Wc=(new iM).build();F(this,this.Wc);lu(this.Wc,this.Xb,X.h8);this.V=this.H=null;this.Qa=[]}u(TX,RX);
var UX={tF:"waffle-assistant-scroll-pane-feature-content",Gec:"waffle-assistant-empty-list",b3a:"waffle-assistant-features",d4a:"waffle-assistant-empty-list-learn-more",Dia:"waffle-assistant-expanded-panel",vCa:"waffle-assistant-replaceable-title",K5a:"waffle-assistant-scroll-pane",w6a:"waffle-assistant-sidepane-tables-range",x6a:"waffle-sidebar-tables-bar",KDa:"waffle-assistant-tables-scroll-pane",y6a:"waffle-assistant-tables-edit-range-button",JR:"waffle-assistant-title"},Wxc={defaultHelpArticleId:"6280499"};
p=TX.prototype;
p.Sa=function(){var a=this;TX.ea.Sa.call(this);this.Ya.ob(this.$a(UX.Dia));dX(this.C.La,"Close");un&&(this.dc.ob(this.$a(UX.w6a)),Sxc(this),this.Xb.ob(this.$a(UX.y6a)));var b=this.Cb.L.lw();nn&&(Isa||"en"==lv(b))&&(b=new JX(this.rf,this.Kb,this.re,this.jg,this.bt(),this.va,this.Cb,this.Wf,this.vd,this.xa()),this.Ta(b),this.D.push(b));b=new lxc(this.bt(),this.va,this.xa());this.Ta(b);this.D.push(b);Ig(K(),"fedvs")&&(b=new cxc(this.bt(),this.va,this.xa()),this.Ta(b),this.D.push(b));b=new mX(this.re,
this.Kb,this.bt(),this.va,this.xa());this.Ta(b);this.D.push(b);var c=this.$a(UX.b3a);x(this.D,function(b){b.render(c);a.Ya.Ta(b.C,!0)});this.xb.ob(this.$a(UX.d4a));this.getHandler().R(this.xb,"action",this.A4b).R(this,"Ge",this.h9).R(this,"Fe",this.B4b);Xxc(this)};p.B4b=function(){var a=Yxc(this);a&&(a.Ca=!0)};p.A4b=function(){O.Ro.Ac(Wxc)};function Uxc(a){x(a.D,function(a){Ltc(a)})}function Qxc(a,b,c,d){x(a.D,function(a){a.vX(b,c,d)})}function Rxc(a){return!!zb(a.D,function(a){return a.Pra()})}
p.Oga=function(){var a=this,b=this.$a("waffle-assistant-scroll-pane").scrollTop+bq(this.$a("waffle-assistant-sidepane-content")).height;x(this.D,function(c){a.F&&a.F!=c||(c instanceof mX&&a.getHandler().Kc(c,"Be",a.qNb),b=c.e6(b))})};function Pxc(a){if(a.F)return a.F.C.C;var b=[];x(a.D,function(a){Ob(b,Ktc(a))});return b}p.Ze=function(a){TX.ea.Ze.call(this,a);Xxc(this)};p.dg=function(a){x(this.D,function(b){b.dg(a)})};p.Hva=function(){var a=this.$a(UX.vCa),b=this.$a(UX.JR);aq(b,bq(a).height)};
p.Gc=function(){var a=this,b=this.$a(UX.tF),c=this.$a(UX.vCa),d=this.Ya.La;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,Q(b,!0),Q(d,!1),Fr(c,Vxc),wp(c,"label"),this.resize();else if(this.F=zb(this.D,function(a){return a.$b()}))Q(b,!1),Q(d,!0),this.F.C.setVisible(!0),Mtc(this.F,c),yp(c,this.F.wX());this.Hva();b=new Ck(function(){var b=Vu;b&&b.dispatchEvent("resize");a.Oga()},300);F(this,b);b.start()};
p.setVisible=function(a){var b=this.kb();TX.ea.setVisible.call(this,a);a&&!b&&Zxc(this,!0);a||this.va.clear()};p.Dra=function(){TX.ea.Dra.call(this);this.F&&this.Gc();this.h9()};p.ora=function(){TX.ea.ora.call(this);Zxc(this,!0)};p.nra=function(){TX.ea.nra.call(this);Zxc(this,!1)};p.Fqa=function(a){TX.ea.Fqa.call(this,a);Zxc(this,!0,a.F)};p.Eqa=function(a){TX.ea.Eqa.call(this,a);Zxc(this,!1)};
function $xc(a,b){if(un){var c=Yxc(a);b?(y_b(a.H),a.H=new txc(a.Cb,a.Kb,a.Fd,a.$,a.Ca,a.Ha,a.bt(),a.vd,null!=c&&c.$b()),a.Ta(a.H),a.H.render(a.getElement())):a.H&&(a.removeChild(a.H,!0),G(a.H),a.H=null);c&&Xwc(c,b)}}function Txc(a,b){if(un&&1!=a.Ha){var c=Yxc(a);b?(a.V=new MX(a.Cb,a.Kb,a.Fd,a.$,a.Ca,a.Ha,null!=c&&c.$b()),a.Ta(a.V),a.V.render(a.getElement())):a.V&&(a.removeChild(a.V,!0),G(a.V),a.V=null);c&&Xwc(c,b)}}function Xxc(a){x(a.D,function(b){b.Ze(a.Gd())})}
function Yxc(a){a=zb(a.D,function(a){return a instanceof JX});return null!=a?a:null}function Zxc(a,b,c){x(a.D,function(a){c||Htc(a.C,b)});un&&b&&(a.$=null,a.Ca=0,a.Ha=null,a.h9(),Sxc(a))}function Sxc(a){var b=a.$a(UX.x6a),c=a.$a(UX.K5a);if(a.$){var d=Gh(a.$);d=gw(d);d=S(rxc,{sJ:d});a=a.dc.Yb();gm(a);a.appendChild(d);Q(b,!0);Bp(c,UX.KDa)}else Q(b,!1),Ep(c,UX.KDa)}p.h9=function(){$xc(this,!1);Txc(this,!1)};function VX(a,b,c,d,e,f,h,k,l,m,r,v){var w=this;LU.call(this,b,h);this.$=a;this.C=b;this.O=c;this.Na=d;this.hb=e;this.L=f;this.H=c.C;this.Qa=this.Ha=!1;this.F=null;this.Jb=l;this.cb=v;this.qd=new Ah;this.J=null;ayc(this);X.s6.eb(!0);a=new ri;N(a,6,byc());b=new pi;ji(b,58,a);this.va=zi(Ai(new yi,b),10).build();this.Ya=Ui.getInstance();this.Ca=Vi(this.Ya,Fj.yAa);a=new Ck(function(){return cyc(w,!1)},100);F(this,a);a.start()}u(VX,LU);
function ayc(a){var b=zv(a.hb);a.Cf().R(a.Na,"selectionChange",a.E4b).R(a.H,"M",a.C4b).R(b,"fa",a.fAb).R(a.C,"ye",a.cpb).R(a.C,"xe",a.bpb).R(a.C,"we",a.$ob).R(a.C,"De",a.xEb).R(a.C,"Ae",a.tqb).R(a.C,"Ce",a.D4b).R(a.C,"He",a.oHb).R(a.C,"Ee",a.UFb).R(a.C,"ze",a.Apb).R(a.C,"Ie",a.G4b).R(a.$.C,"recommender-confidence-update",a.Wrb).R(a.C,"Fe",a.F4b);gp(a.V,X.bQ,uo,a.ayb).subscribe(X.cQ,"action",a.xpb).subscribe(X.t6,"action",a.XGb).subscribe(X.eha,"action",a.YUa).subscribe(X.hx,"action",a.NBb).subscribe(X.h8,
"action",a.kHb)}p=VX.prototype;p.Vh=function(){return X.fha};p.Nu=function(){return X.lza};p.Br=function(a){VX.ea.Br.call(this,a);X.t6.eb(a);cyc(this,!1);!this.Ha&&a&&(this.Ha=!0);jo(this.cb,{Nb:a})};p.J2=function(a){var b=this;this.C.Hva();var c=new Ck(function(){VX.ea.J2.call(b,a)},300);F(this,c);c.start()};p.Kqa=function(){VX.ea.Kqa.call(this);WX(this,2226)};p.dg=function(a){this.C.dg(a);this.$.dg(a)};
p.cpb=function(a){var b=a.C.D,c=B(B(b,13),3);b=GT(b);var d=new ce;C(d,1,c);c=new de;C(c,1,d);C(c,3,!0);C(c,4,!0);this.L.C(new PV(c,b));WX(this,a.zj())};p.xpb=function(){var a=this.C.kb();this.Vh().setVisible(!a);a||this.C.focus();a?WX(this,2226):WX(this,2253)};p.YUa=function(){this.C.kb()||this.Br(!0)};p.NBb=function(){var a=Yxc(this.C);a&&!a.$b()&&(this.YUa(),Zwc(a,"",!0))};p.XGb=function(a){Oxc(this.C,a)};p.kHb=function(){$xc(this.C,!0)};p.E4b=function(){Fv(this.O)&&null==this.C.H&&cyc(this,!0)};
function cyc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.kb()&&(Dxc(d.cb),SX(d));a.$.update(!b,a.C.kb(),c)}
p.Wrb=function(a){""!=this.Ca&&(Wi(this.Ya,this.Ca),this.Ca="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Ih()>=Csa&&uh(c,"r")>=Esa&&uh(c,"c")>=Fsa&&c.Ih()<=Dsa)&&.6<=b;if(d!==this.Qa||a&&!a.equals(this.F))this.Qa=d,this.F=a,X.s6.Ac({Uca:d,sJ:a});c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.Ih(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.Yc,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.kb()&&!this.Ha&&c&&d&&!sv(this.O),a=tsa&&a,d=usa&&this.O.Gd(),c&&(a||d)&&(c=
new ri,N(c,1,b),N(c,2,a),N(c,3,d),N(c,5,Jsa),N(c,6,byc()),b=new pi,ji(b,58,c),b=Ai(zi(new yi,10),b).build(),this.dFa(b)))};p.dFa=function(a){var b=this;this.C.wc=!0;var c=YUa(ov(this.H));if(!$Wb.C&&!c){var d=a||this.va;this.Vh().setVisible(!0);this.Jb.hc(2225,d);WX(this,2253);a=new Ck(function(){b.C.kb()||b.Jb.hc(2752,d)},5E3);F(this,a);a.start()}};function byc(){switch(Gsa){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}
p.Apb=function(){this.C.Gc()};p.G4b=function(a){var b=a.C,c=GT(b.D),d=parseInt(c.Lb(),10);this.J=Gh(c);this.L.C(new RXb(d));ixc(b,c);WX(this,a.zj())};p.C4b=function(){Nv(this.H)?(this.C.eb(!0),cyc(this,!1)):(this.Vh().setVisible(!1),this.C.eb(!1))};p.ayb=function(){this.C.Ze(!X.bQ.isEnabled())};p.fAb=function(a){cyc(this,!1,$Ia(a))};
p.bpb=function(a){var b=ov(this.H),c=""+b.yc(),d=[],e=Wkc(b);if(e){b=new Ze;var f=Fc(e,2);C(b,3,f);f=Fc(e,2);C(b,2,f);e=Fc(e,1);C(b,1,e);d.push(b)}b=a.C.xb;for(e=0;e<b.length;e++)f=new Ze,C(f,2,b[e]),d.push(f);this.L.C(new HV(d,c));WX(this,a.zj())};
p.$ob=function(a){var b=a.C,c=Slc(b.C),d=GT(b.D),e=c.yv?c.oy:null,f=c.C?c.Nx:null,h=parseInt(d.Lb(),10),k=dyc(d);this.J=Gh(d);k?this.L.C(new KU(k,h,this.J,e,c.Ws,c.Ut,f)):this.L.C(new IU(h,this.J,e,c.Ws,c.Ut,f));d=new nlc;N(d,1,1);c=new LT;b=B(b.D,2);N(c,2,b);ji(c,5,d);b=Stc(this.F);ji(b,46,c);b=Ai(zi(new yi,10),b).build();this.Jb.C(a.zj(),b)};p.xEb=function(a){a=a.C;var b=GT(a.D),c=parseInt(b.Lb(),10),d=dyc(b);this.J=Gh(b);this.L.C(new JU(d,c));ixc(a,b)};
p.F4b=function(a){var b=ov(this.O.C),c=b.yc();b=Eh(MJa(a.L,b),c);c=Qtc(b,a.F,a.V);var d=this.$,e=a.F;yIa(d.C);d.C.Qa=b;d.C.Ha=c;d.C.Na=e;IIa(d.C,!0,!0);WX(this,a.zj())};function dyc(a){var b=a.Lb();a=Gh(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.tc(),a.qc(),a.Nc(),a.Sc(),7,!1);return 0<b.length?b[0]:null}p.tqb=function(a){$A(ov(this.H),a.J);WX(this,a.zj())};
p.oHb=function(a){var b=a.C;a=a.zj();if(b instanceof CX||b instanceof GX)WX(this,a);else{var c=Pxc(this.C),d=new LT,e=B(b.D,2);c=c.indexOf(b);N(d,1,c);N(d,2,e);e=new pi;ji(e,46,d);if(b instanceof jX){(d=b.H)?(b=eyc(this,b,d),b=Soc(b,d,d.hf())):b=null;if(!b)return;ji(e,39,b)}else if(b instanceof lX){var f=b.D;c=new Zsc;if(b instanceof lX)b=1;else throw Error("Unknown text analysis card type.");f=Ec(B(f,8),20).slice(0,10);N(c,2,f||[]);N(c,1,b);ji(d,3,c)}e=Ai(zi(new yi,10),e).build();this.Jb.C(a,e)}};
p.UFb=function(){this.C.Gc()};
p.D4b=function(a){var b=a.L;if(b){var c=ov(this.H),d=a.We();d||(d=lB(this.Na).od().C.We());var e=16,f=16,h=a.Qa;h&&(e=h.x,f=h.y);h=Zjc(this.O.J);d={oid:null,ar:gB(c,d.y),ac:hB(c,d.x),x:e,y:f,h:rB.height,w:rB.width,p:{context:{chartName:"Chart "+(h+1)}}};(c=b.hf())?(e=new Jm(c),d=new eD(nv(this.H)||0,d,!1,!1),f=Tm(e,"headers"),f=null!=f&&qa(f)&&Wa(f)?parseInt(f,10):-1,d.hb=f,d.$=0,f="1"==Tm(e,"transpose"),d.Ya=f,d.L=f?"ROWS":"COLS",f=Tm(e,"range"),f=$kc(cU(f,","),this.H),d.iJ(f),(e=Tm(e,"dt"))&&W_a(d,
this.qd.Pc(mf.Pa(),JSON.parse(decodeURIComponent(e))))):(e=new uf,C(e,2,"0.6"),f=a.Ed().toJSON(),C(e,1,f),d=new eD(nv(this.H)||0,d,!1,!1,e));ET(d,b);this.Na.dispatchEvent(new RD("objectRequest"));this.L.C(new zG(this.O,d));e=fyc(this,b,a.V,a.Ed());e.bl(d.getId()||0);DV(this.Jb,a.zj(),e,10,b,c,void 0,a.F)}};function eyc(a,b,c){var d=Pxc(a.C).filter(function(a){return a instanceof jX});return fyc(a,c,d.indexOf(b),b.H&&b.H.Ed())}
function fyc(a,b,c,d){var e=new CV;a=Pxc(a.C).filter(function(a){return a instanceof jX}).map(function(a){return a.getChartType()});e.O=a;e.H=c;Poc(e,b.getChartType());e.F=d?d.clone():null;return e}function WX(a,b){if(a.F){var c=hi(nja(a.va),ri,58).getTableRange();if(!c||c.Lb()!=a.F.Yc||c.qc()!=a.F.rect.qc()||c.tc()!=a.F.rect.tc()||c.Sc()!=a.F.rect.Sc()||c.Nc()!=a.F.rect.Nc()){c=new ri;N(c,6,byc());var d=Rtc(a.F);ji(c,7,d);d=new pi;ji(d,58,c);a.va=zi(Ai(new yi,d),10).build()}}a.Jb.hc(b,a.va)};function gyc(){D.call(this)}u(gyc,Cn);gyc.prototype.C=function(){return Lxc};gyc.prototype.F=function(){return TX};gyc.prototype.D=function(){return VX};Qn("assistant",gyc);
