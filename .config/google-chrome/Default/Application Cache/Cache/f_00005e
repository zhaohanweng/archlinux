pi.prototype.eU=ea(53,function(){return L(this,56)});function Bzd(a,b){var c=new BF,d;for(d in a.C)d in b.C||(c.C[d]=null);return c}function Czd(a){a=a||{};return V(GFa(Nr({u0:Or("docs-icon-close-small")},a)))}
function Dzd(a){return V("<div"+(a.id?' id="'+W(a.id)+'"':"")+' class="'+(a.Fg?W(a.Fg)+" ":"")+W("goog-flat-menu-button")+" "+W("goog-flat-menu-button-disabled")+" "+W("goog-inline-block")+'" role="button"'+(a.vu?' aria-label="'+W(a.vu)+'"':"")+'><div class="'+W("goog-flat-menu-button-caption")+" "+W("goog-inline-block")+'">'+U(a.pC)+'</div><div class="'+W("goog-flat-menu-button-dropdown")+" "+W("goog-inline-block")+'" aria-hidden="true">&nbsp;</div>'+(a.Bl?U(a.Bl):"")+"</div>")}
function Ezd(a){ci(this,a,0,-1,null)}u(Ezd,bi);Ezd.prototype.getContext=function(){return L(this,1)};Ezd.prototype.setContext=function(a){N(this,1,a)};Ezd.prototype.Uv=function(){N(this,1,void 0)};function Fzd(a,b){ho.call(this);this.C=a;this.D[a]=b}u(Fzd,ho);Fzd.prototype.un=function(a){var b={};b[this.C]=a;jo(this,b)};function p6(){BD.call(this);this.C=new BF;CD(this,new zD(AD,{},{wordList:[]}));this.J=new wg;F(this,this.J)}u(p6,BD);za(p6);p6.prototype.F=function(a){Gzd(this,a,!0)};function Gzd(a,b,c){var d=a.C.contains(b.toLowerCase()),e=b.toLowerCase();a.C.add(e);if(!d){var f={};f.value=e;DD(a).get("wordList").push(f);c&&Hzd(a,[b],[])}return!d}p6.prototype.L=function(a){Izd(this,a,!0)};
function Izd(a,b,c){var d=a.C.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.C.remove(e);for(var f=DD(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&Hzd(a,[],[b])}return d}p6.prototype.H=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)Gzd(this,a[b].value,!1);a.length&&this.J.dispatchEvent(null)};function Hzd(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.J.dispatchEvent(null);a.D.dispatchEvent(new FD(new ED("docs-user_dictionary",d),DD(a)))};function Jzd(a,b,c){as.call(this,a,b,c);Cq(this,"Preferences")}u(Jzd,as);p=Jzd.prototype;p.Sa=function(){Jzd.ea.Sa.call(this);this.getHandler().R(this,"dialogselect",this.nbb)};p.setVisible=function(a){Jzd.ea.setVisible.call(this,a);a&&this.update()};p.update=xa;p.nbb=function(a){"ok"==a.key&&this.cXa()};p.cXa=xa;function Kzd(a){a='<b>"'+(U(a.zX)+'"</b> added to your personal dictionary.');return V(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function Lzd(a){a='<b>"'+(U(a.zX)+'"</b> removed from your personal dictionary.');return V(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}
function Mzd(a){a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input '+W("jfk-textinput")+'" type="text" aria-label="'+W(a.LRa)+'" placeholder="'+W(a.LRa)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+U(Os({Ae:"docs-userdictionarydialog-button-add",style:0,content:Pr("Add")}))+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>');return V(a)}
function Nzd(a){return V('<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+W(a.zX)+'" class="docs-userdictionarydialog-row-content">'+U(a.zX)+"</div></div>")};function q6(a,b){er.call(this,void 0,new Ozd);this.Sya=a;this.C=b}u(q6,er);q6.prototype.gq=ba();q6.prototype.XU=function(a){a.relatedTarget&&rm(this.C,a.relatedTarget)||q6.ea.XU.call(this,a)};q6.prototype.Oj=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Ci(a)};function Ozd(){}u(Ozd,Zq);Ozd.prototype.Ec=n("docs-userdictionarydialog-row-container");Ozd.prototype.Da=function(a){return S(Nzd,{zX:a.Sya})};function r6(a){Ws.call(this,void 0,new Pzd);this.D=a;this.C=this.F=null}u(r6,Ws);p=r6.prototype;p.Sa=function(){r6.ea.Sa.call(this);yp(this.La,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");tp(this.La,"listbox");var a=this.F;Q(a,!1);gq(a,!0);this.C=new Wq(a);this.getHandler().R(this,"action",this.Pua).R(this.F,"click",this.Pua).R(this.C,"key",this.Wpb)};p.ud=function(){r6.ea.ud.call(this);G(this.C);this.C=null};
function Qzd(a){var b=[];a.Zf(function(a){b.push(a.Sya)});return b}p.Pua=function(){var a=Zs(this),b=this.wk==this.jd()-1;at(this);this.removeChild(a,!0);b||bt(this);Rzd(this);this.dispatchEvent("change")};p.Wpb=function(a){return 13==a.keyCode||32==a.keyCode?(this.Pua(),a.preventDefault(),a.stopPropagation(),!0):!1};p.hD=function(){0==this.Zi("docs-userdictionarydialog-row-container-hover").length&&$s(this)};p.uw=function(a){a.stopPropagation();a.preventDefault()};
p.vk=function(a){return 27==a.keyCode?!1:r6.ea.vk.call(this,a)};p.V1=function(a){r6.ea.V1.call(this,a);Rzd(this)};p.ypa=function(a){var b=Am(document);r6.ea.ypa.call(this,a);b&&Ap(b,"docs-userdictionarydialog-list-remove-button")?this.La.focus():Rzd(this)};function Rzd(a){if(Zs(a)){var b=Zs(a),c=Math.round((bq(b.La).height-bq(a.F).height)/2);a.F.style.top=Rp(b.La).y+c+"px";yp(a.F,"Remove "+b.Sya);Q(a.F,!0)}else Q(a.F,!1)}function Pzd(){this.C=void 0}u(Pzd,Vs);
Pzd.prototype.qs=function(a){var b=S(Czd,{enabled:!0,Fg:"docs-userdictionarydialog-list-remove-button"});a.F=b;a.getElement().appendChild(b)};function s6(a,b,c,d){Jzd.call(this,b,c,d);this.V=a;this.F=new Ps(null,d);this.Ta(this.F);this.L=this.C=null;this.J=new r6(a);this.Ta(this.J);this.O=null;Cq(this,"Personal dictionary");a=Sq((new Nq).set("ok","Save",!0),Vq,!1,!0);Qq(this,a)}u(s6,Jzd);p=s6.prototype;p.Da=function(){s6.ea.Da.call(this);Fr(this.Yb(),Mzd,{LRa:"Add a new word"});yr(this,"ok");this.F.ob(this.$a("docs-userdictionarydialog-button-add"));this.J.ob(this.$a("docs-userdictionarydialog-list-container"));this.C=this.$a("docs-userdictionarydialog-input")};
p.Sa=function(){s6.ea.Sa.call(this);this.F.eb(!1);this.L=new zr(this.C);this.getHandler().R(this.F,"action",this.hob).R(this.C,"keypress",this.Ucb).R(this.L,"input",this.Tcb).R(this.J,"change",this.ttb);this.getHandler().R(this.F.getElement(),"focus",this.Vma).R(this.C,"focus",this.Vma);for(var a=eAa(this.D),b=0;b<a.length;b++)this.getHandler().R(a[b],"focus",this.Vma);this.O=new sJ(this.J)};p.ud=function(){s6.ea.ud.call(this);Ic(this.L,this.O);this.O=this.L=null};p.hob=function(){Szd(this)};
p.Tcb=function(){this.F.eb(!Ua(ib(this.C.value)))};p.Ucb=function(a){13==a.keyCode&&(this.F.isEnabled()&&Szd(this),a.stopPropagation(),a.preventDefault())};p.Vma=function(){this.J.Bj(-1)};p.ttb=function(){Rq(this.D,"ok").disabled=!1};p.update=function(){var a=this.J;a.Kd(!0);var b=a.D.C.kd();b.sort(pqc());for(var c=0;c<b.length;c++)a.Ta(new q6(b[c],a.F),!0);Tzd(this,"");Rq(this.D,"ok").disabled=!0};
p.cXa=function(){var a=this.J;var b=new BF(a.D.C.kd());var c=new BF(Qzd(a));a=Bzd(c,b).kd();b=Bzd(b,c).kd();c=this.V;for(var d=[],e=[],f=0;f<a.length;f++)Gzd(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)Izd(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&Hzd(c,d,e)};
p.setVisible=function(a){s6.ea.setVisible.call(this,a);if(a){var b=this.C;b&&(b.focus(),a=b.value.length,RGa(b)?(b.selectionStart=a,b.selectionEnd=a):Oc&&!Yc("9")&&(a=TGa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};function Tzd(a,b,c){a.C.value=b;a.F.eb(!Ua(ib(a.C.value)));c&&a.C.select()}
function Szd(a){var b=a.J,c=a.C.value;c=c.toLowerCase().trim();-1==Qzd(b).indexOf(c)&&(c=new q6(c,b.F),b.Nh(c,0,!0),b.La.scrollTop=0,b.dispatchEvent("change"));Im(a.xa())==a.C&&a.C.blur();Tzd(a,"");a.C.focus()};function Uzd(a,b){var c=new s6(p6.getInstance());a.wj(c);return Ia(Vzd,c,b)}function Vzd(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&Tzd(a,c,!0)};function Wzd(){D.call(this);this.C=new tg;this.D=new wg;F(this,this.D)}u(Wzd,D);function Xzd(a,b,c){this.C=a;this.D=b;this.F=c||null}Xzd.prototype.equals=function(a){return this.C.equals(a.C)&&this.D.equals(a.getSelection())};Xzd.prototype.getSelection=g("D");function Yzd(a,b){this.D=a;this.C=b};function Zzd(a,b,c){this.C=a;this.F=b;this.D=c||null}Zzd.prototype.mw=g("F");function $zd(a,b,c,d,e,f){this.F=a;this.L=b;this.C=c;this.D=d;this.H=e;this.J=f||null;this.Ra=new J(this);F(this,this.Ra)}u($zd,D);p=$zd.prototype;p.Scb=function(a){var b=this.C.C;aAd(this.D,a);bAd(this,b,!0)};
p.rqb=function(a){var b=this.C.C,c=this.D,d=fb(a.C.mw()),e=a.D;a=new sx;C(a,1,"\\b"+d+"\\b");C(a,3,e);C(a,6,!1);C(a,7,!1);C(a,8,!0);a.setType(2);C(a,11,0);d=c.C.F;switch(c.C.$){case "RANGE":C(a,5,0);a.setSelection(Eh(d.rect,d.Yc));var f=kA(c.D,d.Yc);break;case "SHEET":C(a,5,1);f=new Qd;C(f,1,""+d.Yc);a.setSelection(f);f=kA(c.D,d.Yc);break;case "WORKBOOK":C(a,5,2),f=c.D.uaa(-1,0,!1)}f=f.Tc();c.F.C(new kW(f,a));bAd(this,b,!0)};
p.sxb=function(a){var b=this.C.C;if(qa(a)){var c=this.L;c.C.contains(a.toLowerCase())||(c.C.add(a.toLowerCase()),c.D.dispatchEvent(null))}bAd(this,b,!1)};p.gsb=function(a){var b=this.C.C;if(a instanceof Xzd){var c=this.D.H,d=a.C.mw();a=a.getSelection();if(!cAd(c,d,a)){var e=c.C[""+a.Yc];e||(e=Mv(c.D,a.Yc),e.getSheetType(),e=e.Tc(),e=new qz(e,!0),c.C[""+a.Yc]=e);c=a.Zc.y;a=a.Zc.x;var f=e.Ve(c,a);f||(f=new tg,rz(e,c,a,f));f.add(d.toLowerCase())}}bAd(this,b,!1)};
p.rCb=function(a){var b=this.C.C;qa(a)&&(this.J?this.J.F(a):p6.getInstance().F(a));bAd(this,b,!1)};p.sIa=function(){O.dja.yd(!1);this.Ra.Lc(this.F,"docs-text-spellcheckdialogcontroller-closed",this.sIa);dAd(this.D.C)};p.vOb=function(){bAd(this,null,!1)};p.BPa=function(a){var b=this.F.C;Q(b.Ha,!1);Q(b.Na,!0);b=this.C;var c=t(this.u_a,this,this.C.C,!1);this.H.C.getSelection();b.C&&(a?b.L.unshift(b.C):b.va.push(b.C));eAd(b,c,!!a)};
function bAd(a,b,c){var d=a.F.C;Q(d.Ha,!1);Q(d.Na,!0);b=t(a.u_a,a,b,c);a.H.C.getSelection();eAd(a.C,b,!1)}
p.u_a=function(a,b){a=this.F;a.C.setVisible(!0);var c=a.C;Q(c.Ha,!0);Q(c.Na,!1);c=a.C;var d=c.J.C;Qi(c.xb);var e=c.xa().Fb("docs-slidingdialog-content",c.getElement());e&&vp(e,"label",d?"Spellcheck":"No spelling suggestions");if(d){e=d.C;var f=c.xa();c.getHandler().Lc(c.F,"focus",c.YPa).Lc(c.F,"blur",c.XPa).Lc(c.O,"input",c.$Pa).Lc(c.F,"keydown",c.ZPa);c.H.gb("");var h=c.F;var k=h.cloneNode(!0);km(k,h);c.F=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!c.F)throw Error("Replacement input not in DOM.");
G(c.removeChild(c.H));c.H=new wP("",f);c.Ta(c.H);c.H.ob(c.F);G(c.O);c.O=new zr(c.F);for(c.getHandler().R(c.F,"focus",c.YPa).R(c.F,"blur",c.XPa).R(c.O,"input",c.$Pa).R(c.F,"keydown",c.ZPa);0<c.D.jd();)c.D.On(0).dispose();f="Next misspelling. Change "+(e.mw()+" to:");vp(c.F,"label",f);c.xa().nf(c.Fd,e.mw());f=e.C;if(0==f.length)c.H.gb(e.mw()),h=new qr("No suggestions"),c.D.Ta(h,!0),h.Sf(2,!1),h.eb(!1),c.wc.un(!1);else{c.H.gb(f[0]);for(e=0;e<f.length;e++)h=new qr(f[e]),c.D.Ta(h,!0),c.getHandler().R(h,
"action",c.fJb).R(h.getElement(),"dblclick",c.Mzb),1<f.length&&(h.hq(!0),h=Xl("goog-menuitem-checkbox",h.La),Bp(h,"goog-inline-block"));(e=c.D.ld(0))&&1<c.D.jd()&&e.rc(!0);c.D.Bj(0);c.wc.un(!0)}sqc(c.Ya,d.getSelection());c.g_a.call(c,c.va,-1);c.g_a.call(c,c.hb,-1);Q(c.pb,!1);Q(c.jb,!0)}else Q(c.jb,!1),gm(c.dc),c.Xb&&c.dc.appendChild(c.Xb),Q(c.pb,!0),c.xb=Pi(t(c.Wu,c),c.Ic),c.Ya.Uv();a.C.focus();(a=this.C.C)?fAd(this.D,a.getSelection()):b&&fAd(this.D)};function gAd(a,b,c,d,e,f){SV.call(this,f);this.L=a;this.J=b;this.Ld=e;this.Ya=new rqc(c);this.Ta(this.Ya);this.$=new Ps(null,f);this.Ta(this.$);this.va=new it(f);this.Cb=null;this.Wc=new nt(null,this.va,GH.getInstance());this.Ta(this.Wc);this.cb=new Ps(null,f);this.Ta(this.cb);this.hb=new it(f);this.Ub=null;this.vd=new nt(null,this.hb,GH.getInstance());this.Ta(this.vd);this.Kb=this.Ca=this.V=null;this.H=new wP("",f);this.Ta(this.H);this.D=new hAd(f);jt(this.D,!1);this.Ta(this.D);this.Xb=this.dc=this.pb=
this.jb=this.O=this.F=null;this.Ic=5E3;this.xb=this.Fd=null;this.wc=d;this.Ha=this.Na=this.Qa=null}u(gAd,SV);function iAd(a){Dp(a.La,["goog-menu-no-icon","goog-menu-noaccel"])}function jAd(a){return 0>a?"":"("+(a+" found)")}p=gAd.prototype;
p.bna=function(){var a=Or("Spellcheck");var b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+U(jqc())+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><div class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</div><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false"></input>'+U(oqc({id:"docs-spellcheckslidingdialog-replacement-context"}))+
"</td><td>"+U(Os({id:"docs-spellcheckslidingdialog-button-change",style:2,Ae:"docs-spellcheckslidingdialog-buttons-action",content:Pr("Change")}))+U(Dzd({id:"docs-spellcheckslidingdialog-button-change-menu",pC:""}))+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+U(Os({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Ae:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",
content:Pr("Ignore")}))+U(Dzd({id:"docs-spellcheckslidingdialog-button-ignore-menu",Fg:"docs-spellcheckslidingdialog-buttons-white-menu",pC:""}))+"<br/>"+U(Os({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Ae:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:Pr("Add to Dictionary")}))+U(Dzd({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Fg:"docs-spellcheckslidingdialog-buttons-white-menu",pC:""}))+"</td></tr></tbody></table></div></div></div>");
b=V(b);a=""+U(Bpc({dHa:a,Il:Pr(""+b)}));return V(a)};p.c$=function(){var a=this.J.C,b=a?a.C.eU():null,c=this.Ld.C.replace(/_/g,"-"),d=a?a.F:null,e=Ig(K(),"docs-anddc"),f=new pi;Ua(ib(b))||N(f,56,b);N(f,60,c);e&&d&&(b=new Ezd,a=a.C.C,0<a.length&&N(b,2,a[0]),b.setContext(d.jHc()),a=d.Lkb().start,N(b,3,a),d=d.Lkb().end,N(b,4,d),ji(f,66,b));return Ai(zi(new yi,1),f).build()};
p.Da=function(){gAd.ea.Da.call(this);var a=bm("SPAN","docs-spellcheckslidingdialog-menu-text","Change all"),b=bm("SPAN","docs-spellcheckslidingdialog-count",jAd(-1));this.Cb=new qr([a,b]);this.va.Ta(this.Cb,!0);a=bm("SPAN","docs-spellcheckslidingdialog-menu-text","Ignore all");b=bm("SPAN","docs-spellcheckslidingdialog-count",jAd(-1));this.Ub=new qr([a,b]);this.hb.Ta(this.Ub,!0)};
p.Sa=function(){gAd.ea.Sa.call(this);Bp(this.La,"docs-spellcheckslidingdialog");var a=this.xa();this.Na=a.getElement("docs-spellcheckslidingdialog-loading");this.Ha=a.getElement("docs-spellcheckslidingdialog-content");this.pb=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.dc=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.jb=a.getElement("docs-spellcheckslidingdialog-misspellings");this.F=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.O=
new zr(this.F);this.Fd=a.getElement("docs-spellcheckslidingdialog-original-word");this.Ya.ob(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.H.ob(this.F);this.$.ob(a.getElement("docs-spellcheckslidingdialog-button-change"));this.cb.ob(a.getElement("docs-spellcheckslidingdialog-button-ignore"));kAd(this.Wc,this.$,"docs-spellcheckslidingdialog-button-change-menu",O.gja,this.L,a);kAd(this.vd,this.cb,"docs-spellcheckslidingdialog-button-ignore-menu",O.ija,this.L,a);this.D.ob(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
this.D.Ei(!0);iAd(this.D);lu(this.L,this.cb,O.j7,mu,t(this.J.Na,this.J),t(this.c$,this));lu(this.L,this.$,O.HX,mu,t(this.Blb,this),t(this.c$,this));this.V=new Ps(null,this.xa());this.Ca=new it(a);this.Kb=new nt(null,this.Ca,GH.getInstance(),a);this.Ta(this.V);this.Ta(this.Kb);this.V.ob(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));lAd(this,this.V,O.J7,!0);kAd(this.Kb,this.V,"docs-spellcheckslidingdialog-button-dictionary-menu",O.hja,this.L,a);a=new qr("View personal dictionary...");
var b=sc(mu);delete b["node-label"];delete b.label;lu(this.L,a,O.$F,b,t(this.daa,this,this.J));this.Ca.Ta(a,!0);iAd(this.Ca);lu(this.L,this.Cb,O.r6,void 0,t(this.V$a,this),t(this.c$,this));iAd(this.va);lAd(this,this.Ub,O.k7,!1);iAd(this.hb);this.getHandler().R(this.D.getElement(),Oc?Wba:"focus",this.HHb);this.Qa=new ip(this.getElement());F(this,this.Qa);a=kya("Ctrl+single-quote",!1);b=kya("Ctrl+semicolon",!1);oya(this.Qa,O.e8,[a]);oya(this.Qa,O.f8,[b])};p.focus=function(){eq(this.jb)?AP(this.H):this.pb.focus()};
function kAd(a,b,c,d,e,f){c=f.getElement(c);a.ob(c);IT(a,1);yVb(a,b.getElement());IT(b,2);b=new ys(c,a.Vf()?1:5);ckc(a,b);lu(e,a,d,mu)}p.g_a=function(a,b){a=Xl("docs-spellcheckslidingdialog-count",a.getElement());this.xa().nf(a,jAd(b))};function mAd(a){var b=a.H.Xa();a=new Zzd(b,a.daa(a.J),a.J);O.HX.Ac(a)}p.Mzb=function(){mAd(this)};p.YPa=function(){var a=this.xa().Wr(this.F);Bp(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};p.XPa=function(){var a=this.xa().Wr(this.F);Ep(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
p.ZPa=function(a){13==a.keyCode&&mAd(this)};p.HHb=function(){for(var a=0;a<this.D.jd();a++){var b=this.D.ld(a);if(b.isChecked()){b.Ng(!0);return}}0<this.D.jd()&&this.D.Bj(0)};function nAd(a){for(var b=0;b<a.D.jd();b++)a.D.ld(b).rc(!1)}p.$Pa=function(){nAd(this);this.wc.un(!0)};p.fJb=function(a){var b=a.target.Xa();nAd(this);this.H.gb(b);(a=a.target)&&1<this.D.jd()&&a.rc(!0);AP(this.H)};p.Blb=function(){var a=this.H.Xa();return new Zzd(a,this.daa(this.J),this.J)};
p.V$a=function(){var a=this.J;a=a.C?a.C.C:null;return new Yzd(this.H.Xa(),a)};function lAd(a,b,c,d){lu(a.L,b,c,d?mu:void 0,t(a.daa,a,a.J),t(a.c$,a))}p.daa=function(a){return(a=a.C)?a.C.mw():null};p.Ka=function(){Qi(this.xb);G(this.O);gAd.ea.Ka.call(this)};function hAd(a,b){it.call(this,a,b)}u(hAd,it);hAd.prototype.vk=function(a){return 27==a.keyCode?!1:hAd.ea.vk.call(this,a)};function oAd(a,b){this.H=a;this.C=b;this.D=0}oAd.prototype.F=function(a){this.H.F(a);a=is(S(Kzd,{zX:a}),O.Sn.getLabel(),t(this.L,this,a),"info",!0,1E4);gs(this.C,this.D);this.D=this.C.postMessage(a)};oAd.prototype.L=function(a){this.H.L(a);a=is(S(Lzd,{zX:a}),O.Sn.getLabel(),t(this.F,this,a),"info",!0,1E4);gs(this.C,this.D);this.D=this.C.postMessage(a)};function pAd(a,b,c,d,e,f,h){I.call(this);this.Db=a;this.H=b;this.J=c;this.D=e;this.rb=h||new Sl;this.C=new gAd(this.H,this.D,this.J,d,f,this.rb);F(this,this.C);this.Ra=new J(this);F(this,this.Ra)}u(pAd,I);pAd.prototype.F=function(){this.Ra.Lc(this.C,"close",this.F);this.dispatchEvent("docs-text-spellcheckdialogcontroller-closed");SDa(st.getInstance())||this.Db.Sb(3);if(!O.jl.isEnabled()){var a=fs.getInstance(),b=hs("Spellcheck will be unavailable until you reconnect.","info",!0,1E4);a.postMessage(b)}};function qAd(a){D.call(this);this.D=a;this.C={};this.fb=new J(this);F(this,this.fb);this.fb.R(a,"X",this.F)}u(qAd,D);function cAd(a,b,c){if(a=a.C[""+c.Yc])if(c=a.Ve(c.Zc.y,c.Zc.x))return!!c.contains(b.toLowerCase());return!1}qAd.prototype.F=function(a){G(this.C[""+a.Zh]);delete this.C[""+a.Zh]};function t6(){y.call(this)}u(t6,y);var rAd=null;t6.prototype.rangeCount=function(){return Ac(this,2)};function u6(){y.call(this)}u(u6,y);var sAd=null;u6.prototype.yc=function(){return B(this,1)};function tAd(){y.call(this)}u(tAd,y);var uAd=null;function v6(){y.call(this)}u(v6,y);var vAd=null;v6.prototype.NM=function(){return B(this,2)};function w6(){y.call(this)}u(w6,y);var wAd=null;w6.prototype.mw=function(){return B(this,1)};w6.prototype.eU=function(){return B(this,5)};
t6.prototype.Pa=function(){var a=rAd;a||(rAd=a=Gc(t6,{0:{name:"SpellcheckRequest",Mb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",Ma:5,type:Number},2:{name:"range",Ma:11,type:Qd},3:{name:"search_all_sheets",Ma:8,type:Boolean},4:{name:"active_filter_views",Uc:!0,Ma:11,type:u6}}));return a};t6.Pa=t6.prototype.Pa;
u6.prototype.Pa=function(){var a=sAd;a||(sAd=a=Gc(u6,{0:{name:"FilterViewDataProto",Mb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",Ma:9,type:String},2:{name:"filter_view_id",Ma:9,type:String}}));return a};u6.Pa=u6.prototype.Pa;
tAd.prototype.Pa=function(){var a=uAd;a||(uAd=a=Gc(tAd,{0:{name:"SpellcheckResponse",Mb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",Ma:5,type:Number},2:{name:"last_column_searched",Ma:5,type:Number},3:{name:"last_grid_id_searched",Ma:9,type:String},4:{name:"searched_all_sheets",Ma:8,type:Boolean},6:{name:"searched_whole_range",Ma:8,type:Boolean},5:{name:"cell_suggestions",Uc:!0,Ma:11,type:v6}}));return a};tAd.Pa=tAd.prototype.Pa;
v6.prototype.Pa=function(){var a=vAd;a||(vAd=a=Gc(v6,{0:{name:"CellSuggestionsProto",Mb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",Uc:!0,Ma:11,type:w6},2:{name:"cell",Ma:11,type:fe}}));return a};v6.Pa=v6.prototype.Pa;
w6.prototype.Pa=function(){var a=wAd;a||(wAd=a=Gc(w6,{0:{name:"PhraseSuggestionsProto",Mb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",Ma:9,type:String},2:{name:"offset_start_index",Ma:5,type:Number},3:{name:"offset_end_index",Ma:5,type:Number},4:{name:"suggestions",Uc:!0,Ma:9,type:String},5:{name:"spelling_language",Ma:9,type:String}}));return a};w6.Pa=w6.prototype.Pa;function xAd(a,b,c){this.D=a;this.F=c||null;this.C=b}xAd.prototype.mw=g("D");xAd.prototype.eU=g("F");xAd.prototype.equals=function(a){var b=a.mw(),c=a.eU();a=a.C;return this.D==b&&this.F==c&&Wb(this.C,a)};function yAd(a,b,c){this.Zc=a;this.Yc=b;this.Cg=c}yAd.prototype.equals=function(a){return this===a?!0:a instanceof yAd?Tg(a.Zc,this.Zc)&&a.Yc==this.Yc&&Vga(a.Cg,this.Cg):!1};function x6(a,b,c,d,e){this.H=a;this.hb=b;this.jb=c;this.cb=d;this.Ya=e;this.D=this.J=this.C=null;this.O=!1;this.L=[];this.va=[];this.fb=new J(this);F(this,this.fb);this.V=null;this.$="RANGE";this.Ha=new Ah;this.Ha.$l=!0;this.Ca=new Ah;this.Ca.$l=!1}u(x6,D);x6.prototype.Na=g("C");
function dAd(a,b,c){wD(a.V);a.fb.Hc();a.$=b;a.F=c;a.O=!1;a.L=[];a.va=[];switch(b){case "WORKBOOK":a.J=new Sg(-1,0);(b=a.H.uaa(-1,0,!1,!0))?a.D=""+b.Lb():(a.D=null,a.O=!0);break;case "SHEET":a.J=new Sg(-1,0);a.D=""+c.Yc;break;case "RANGE":a.J=new Sg(c.rect.left-1,c.rect.top),a.D=""+c.Yc}}function zAd(a,b){var c=b.getSelection(),d=kA(a.H,c.Yc),e;(e=!d)||(d=d.Tc(),e=c.Zc,e=!(QA(xw(d,"r"),e.y)&&QA(xw(d,"c"),e.x)));if(e)return!1;c=c.Cg;a=AAd(a,b);b=b.C.mw();return a.substring(c.start,c.end)==b}
function AAd(a,b){a=BAd(a,b);return Oa(a,"'")?a.substring(1):a}function CAd(a,b){a=BAd(a,b);return Oa(a,"'")}function BAd(a,b){b=b.getSelection();var c=b.Zc,d=b.Yc;a=kA(a.H,d).Tc();a.$t(ih(b.Zc));return uw(a.Qf(c.y,c.x),d,c.y,c.x)}
function DAd(a,b){if(a.D){var c=new t6,d=new Qd;C(d,1,a.D);C(d,2,a.J.y);switch(a.$){case "WORKBOOK":C(c,3,!0);Sd(d,0);var e=b1a(a.H);for(var f=0;f<e.length;f++)0==e[f].getSheetType()&&EAd(c,e[f]);break;case "SHEET":Sd(d,0);e=kA(a.H,a.F.Yc);EAd(c,e);break;case "RANGE":Sd(d,a.F.rect.qc()),Rd(d,a.F.rect.Nc()),Td(d,a.F.rect.Sc()),e=kA(a.H,a.F.Yc),EAd(c,e)}C(c,2,d);C(c,1,a.J.x+1);ak(bk(Wk(ck(a.hb.yf("/spell"),{data:a.Ha.serialize(c)}),"POST"),function(a){this.Uk(a,b)},a),function(){this.Uk(null,b)},a).Re()}else FAd(a,
b,!1)}function EAd(a,b){if(b){var c=b.Tc().H;if(Ov(c)){b=""+b.Lb();c=Rv(c);var d=new u6;C(d,1,b);C(d,2,c);Bc(a,4,d)}}}
x6.prototype.Uk=function(a,b){if(a){a=this.Ca.Pc(tAd.Pa(),a.Kf());this.J=new Sg(B(a,2),B(a,1));this.D=B(a,3);this.O=B(a,6);a=Ec(a,5);for(var c=0;c<a.length;c++){var d=a[c],e=d.NM().iA(),f=d.NM().getColumnIndex();e=new Sg(f,e);f=parseInt(d.NM().Lb(),10);d=Ec(d,1);for(var h=0;h<d.length;h++){var k=d[h],l=k.mw(),m=B(k,2),r=B(k,3),v=k.eU();m=new yAd(e,f,new Wg(m,r));GAd(this,l,m)||(k=Ec(k,4),this.L.push(new Xzd(new xAd(l,k,v),m)))}}}eAd(this,b,!1)};
function eAd(a,b,c){if(c){var d=a.va;var e=t(d.pop,d)}else d=a.L,e=t(d.shift,d);for(;0<d.length;){var f=e(),h=f.C.mw();if(!GAd(a,h,f.getSelection())){e=c;h=f.getSelection();c=kA(a.H,h.Yc);d=c.Tc();h=ih(h.Zc);f=t(a.Qa,a,f,b,e);d.$t(h)?f():(wD(a.V),a.V=mv(c.D,h).addCallback(f));return}}FAd(a,b,c)}function FAd(a,b,c){a.O||c?(a.C=null,b(null)):DAd(a,b)}x6.prototype.Qa=function(a,b,c){zAd(this,a)?(this.C=a,b(a.C)):eAd(this,b,c)};
function GAd(a,b,c){return a.cb.C.contains(b.toLowerCase())||cAd(a.Ya,b,c)||a.jb.C.contains(b.toLowerCase())}x6.prototype.Ka=function(){x6.ea.Ka.call(this);wD(this.V)};function HAd(a,b,c,d){this.D=a;this.F=b;this.C=c;this.H=d}
function aAd(a,b){var c=b.D.C;if(zAd(a.C,c)){var d=c.getSelection(),e=d.Yc,f=d.Cg,h=kA(a.D,e).Tc(),k=CAd(a.C,c);c=AAd(a.C,c);var l=new DG(h,ih(d.Zc),(k?"'":"")+c.substring(0,f.start)+b.C+c.substring(f.end));hx(l,t(function(a){if(a){a=this.C;for(var c=b.C,e=0;e<a.L.length;e++){var f=a.L[e].getSelection();if(Tg(f.Zc,d.Zc)&&f.Yc==d.Yc&&f.Cg.start>d.Cg.end){var h=Xg(d.Cg)-c.length;f.Cg.start-=h;f.Cg.end-=h}}}},a));DT(a.D,new xh(e,"",ih(d.Zc)),t(function(){this.F.C(l)},a))}}
function fAd(a,b){b&&DT(a.D,new xh(b.Yc,"",ih(b.Zc)))};function IAd(a){this.vj=new tqc(a)}IAd.prototype.C=function(a){var b=new Ef,c=new Qd;C(c,2,a.Zc.y);Rd(c,a.Zc.y+1);Sd(c,a.Zc.x);Td(c,a.Zc.x+1);C(c,1,""+a.Yc);Bc(b,2,c);c=new fe;C(c,1,""+a.Yc);C(c,2,a.Zc.y);C(c,3,a.Zc.x);C(b,1,c);return this.vj.C(new Hh(b))};function JAd(a,b,c,d,e,f,h,k){QV.call(this,"docs-spellcheckslidingdialog-id",c,t(this.wya,this));this.va=a;this.Na=new oAd(p6.getInstance(),fs.getInstance());this.$=new Wzd;this.V=new qAd(a);this.H=new x6(a,e,p6.getInstance(),this.$,this.V);this.Ha=new HAd(a,b,this.H,this.V);b=Rl();a=new pAd(c,(new iM).build(),new IAd(a),new Fzd("trigger-text",!1),this.H,k,b);F(this,a);this.O=a.C;this.D=new $zd(a,this.$,this.H,this.Ha,d,this.Na);this.F=b.Da("DIV",{style:"margin-top: 10px"});this.J=QO("Search the rest of the sheet",
b);this.J.render(this.F);this.getHandler().R(this.J,"action",this.LWb);this.L=QO("Search all sheets",b);this.L.render(this.F);this.getHandler().R(this.L,"action",t(this.wya,this,"WORKBOOK"));GD(h,p6.getInstance(),"docs-user_dictionary");O.j7.subscribe("action",this.D.gsb,this.D);O.k7.subscribe("action",this.D.sxb,this.D);O.J7.subscribe("action",this.D.rCb,this.D);O.HX.subscribe("action",this.D.Scb,this.D);O.r6.subscribe("action",this.D.rqb,this.D);O.e8.subscribe("action",t(this.D.BPa,this.D,!1));
O.f8.subscribe("action",t(this.D.BPa,this.D,!0));O.$F.setVisible(!0);O.$F.subscribe("action",Uzd(f,Uf(this.O)))}u(JAd,QV);p=JAd.prototype;p.$T=g("O");p.Cv=function(){JAd.ea.Cv.call(this);this.getHandler().R(this.C,"close",this.h3b).R(this.va,"ba",this.i3b)};p.h3b=function(){this.OC()};p.i3b=function(){this.C.Wu();this.OC()};
p.wya=function(a,b){var c=b||null,d;a||((b=this.va.C)?0==b.getSheetType()?(c=b.Tc().Oc(),1<c.Ih()?(a="RANGE",c=new xh(b.Lb(),b.C,c)):(a="SHEET",c=new xh(b.Lb(),b.C,null))):a="WORKBOOK":a="WORKBOOK");"WORKBOOK"!=a&&(d=15E3);switch(a){case "RANGE":this.J.setVisible(!0);this.L.setVisible(!0);Q(this.F,!0);break;case "SHEET":this.J.setVisible(!1);this.L.setVisible(!0);Q(this.F,!0);break;case "WORKBOOK":Q(this.F,!1)}dAd(this.H,a,c);a=this.O;a.Xb=this.F;a.Ic=d?d:5E3;a=this.D;O.dja.yd(!0);a.Ra.R(a.F,"docs-text-spellcheckdialogcontroller-closed",
a.sIa);d=a.F;a=t(a.vOb,a);b=d.D.C;d.C.gc()||d.C.render(Bm(d.rb,"docs-spellcheckslidingdialog-id"));(c=d.C.hM)&&b?d.C.focus():(c||d.Ra.R(d.C,"close",d.F),a())};p.LWb=function(){var a=this.H.F;this.wya("SHEET",new xh(a.Yc,a.Eh,null))};function KAd(){D.call(this)}u(KAd,Cn);KAd.prototype.C=function(a,b,c,d,e,f,h,k){return new JAd(a,b,c,d,e,f,h,k)};Qn("spellcheck",KAd);
